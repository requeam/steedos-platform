function module(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a,r=_(e("../../core/utils/common")),s,o=_(e("./rendering_strategies/ui.scheduler.appointments.strategy.vertical")),l,u=_(e("./rendering_strategies/ui.scheduler.appointments.strategy.horizontal")),c,g=_(e("./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line")),h,p=_(e("./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month")),d,f=_(e("./rendering_strategies/ui.scheduler.appointments.strategy.agenda"));function _(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var v={horizontal:u.default,horizontalMonth:p.default,horizontalMonthLine:g.default,vertical:o.default,agenda:f.default},y=function(){function e(t,n){m(this,e),this.instance=t,n&&this.initRenderingStrategy(n)}return i(e,[{key:"getCellDimensions",value:function(e){this.instance._workSpace&&e.callback(this.instance._workSpace.getCellWidth(),this.instance._workSpace.getCellHeight(),this.instance._workSpace.getAllDayHeight())}},{key:"getGroupOrientation",value:function(e){this.instance._workSpace&&e.callback(this.instance._workSpace._getRealGroupOrientation())}},{key:"initRenderingStrategy",value:function(e){var t=v[e];this._renderingStrategyInstance=new t(this.instance),this.renderingStrategy=e}},{key:"createAppointmentsMap",value:function(e){var t=this;return this.getCellDimensions({callback:function(e,n,i){t.instance._cellWidth=e,t.instance._cellHeight=n,t.instance._allDayCellHeight=i}}),this.getGroupOrientation({callback:function(e){return t.instance._groupOrientation=e}}),this._positionMap=this._renderingStrategyInstance.createTaskPositionMap(e),this._createAppointmentsMapCore(e||[],this._positionMap)}},{key:"_createAppointmentsMapCore",value:function(e,t){var n=this;return e.map((function(e,i){n._renderingStrategyInstance.keepAppointmentSettings()||delete e.settings;var a=t[i];return a.forEach((function(e){e.direction="vertical"!==n.renderingStrategy||e.allDay?"horizontal":"vertical"})),{itemData:e,settings:a,needRepaint:!0,needRemove:!1}}))}},{key:"_hasChangesInData",value:function(e){var t;return this.instance.getUpdatedAppointment()===e||this.instance.getUpdatedAppointmentKeys().some((function(t){return e[t.key]===t.value}))}},{key:"_hasChangesInSettings",value:function(e,t){if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++){var i=e[n],a=t[n];if(a&&(a.sortedIndex=i.sortedIndex),!r.default.equalByValue(i,a))return!0}return!1}},{key:"_getEqualAppointmentFromList",value:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(i.itemData===e.itemData)return i}return null}},{key:"_getDeletedAppointments",value:function(e,t){for(var n=[],i=0;i<t.length;i++){var a=t[i],r;this._getEqualAppointmentFromList(a,e)||(a.needRemove=!0,n.push(a))}return n}},{key:"getRepaintedAppointments",value:function(e,t){if(0===t.length||"agenda"===this.renderingStrategy)return e;for(var n=0;n<e.length;n++){var i=e[n],a=this._getEqualAppointmentFromList(i,t);a&&(i.needRepaint=this._hasChangesInData(i.itemData)||this._hasChangesInSettings(i.settings,a.settings))}return e.concat(this._getDeletedAppointments(e,t))}},{key:"getRenderingStrategyInstance",value:function(){return this._renderingStrategyInstance}}]),e}();n.exports=y}

