function module(e,t,l){"use strict";var a=e("../../../core/renderer"),i=e("../../../core/dom_adapter"),n=e("../../../events/core/events_engine"),o=e("../../../core/element_data"),s=e("../../../core/utils/date"),r=e("../../../core/utils/type"),h=e("../../../core/utils/window"),u=e("../../../core/utils/dom").getPublicElement,c=e("../../../core/utils/extend").extend,d=e("../../../core/utils/iterator").each,g=e("../../../localization/message"),_=e("../../../localization/date"),p=s.dateToMilliseconds,C=e("../../widget/ui.widget"),f=C.abstract,D=e("../../../core/utils/common").noop,b=e("../../../core/utils/type").isDefined,y=e("../ui.scheduler.publisher_mixin"),T=e("../../../events/utils"),v=e("../../../events/pointer"),S=e("../../widget/ui.errors"),m=e("../../../events/click"),x=e("../../../events/contextmenu"),w=e("../../../events/drag"),$=e("../../scroll_view/ui.scrollable"),k=e("./ui.scheduler.work_space.grouped.strategy.horizontal"),G=e("./ui.scheduler.work_space.grouped.strategy.vertical"),A=e("../ui.scheduler.table_creator"),I=e("../shaders/ui.scheduler.current_time_shader.vertical"),B="dx-scheduler-work-space",H="dx-scheduler-work-space-grouped",P="dx-scheduler-work-space-vertical-grouped",W="dx-scheduler-work-space-vertical-group-table",R="dx-scheduler-work-space-both-scrollbar",E="dx-scheduler-work-space-count",V="dx-scheduler-work-space-group-by-date",O="dx-scheduler-work-space-odd-cells",M="dx-scheduler-work-space-overlapping",F="dx-scheduler-time-panel",z="dx-scheduler-time-panel-cell",L="dx-scheduler-time-panel-row",N="dx-scheduler-all-day-panel",q="dx-scheduler-all-day-table",K="dx-scheduler-fixed-appointments",U="dx-scheduler-all-day-appointments",J="dx-scheduler-all-day-title",j="dx-scheduler-all-day-title-hidden",Z="dx-scheduler-all-day-table-cell",Q="dx-scheduler-all-day-table-row",X="dx-scheduler-work-space-all-day",Y="dx-scheduler-work-space-all-day-collapsed",ee="dx-scheduler-work-space-mouse-selection",te="dx-scheduler-cell-sizes-horizontal",le="dx-scheduler-cell-sizes-vertical",ae="dx-scheduler-header-panel",ie="dx-scheduler-header-panel-cell",ne="dx-scheduler-header-row",oe="dx-scheduler-group-row",se="dx-scheduler-group-header",re="dx-scheduler-group-header-content",he="dx-scheduler-date-table",ue="dx-scheduler-date-table-cell",ce="dx-scheduler-date-table-row",de="dx-scheduler-focused-cell",ge="dx-scheduler-date-table-droppable-cell",_e="dx-scheduler-header-scrollable",pe="dx-scheduler-sidebar-scrollable",Ce="dx-scheduler-date-table-scrollable",fe=T.addNamespace(v.down,"dxSchedulerWorkSpace"),De=T.addNamespace(w.enter,"dxSchedulerDateTable"),be=T.addNamespace(w.drop,"dxSchedulerDateTable"),ye=T.addNamespace(m.name,"dxSchedulerDateTable"),Te=T.addNamespace(v.down,"dxSchedulerDateTable"),ve=T.addNamespace(v.up,"dxSchedulerDateTable"),Se=T.addNamespace(v.move,"dxSchedulerDateTable"),me="dxCellData",xe=1,we=75,$e=p("day"),ke=p("hour"),Ge=function(e){return _.getDayNames("abbreviated")[e.getDay()]},Ae=C.inherit({_supportedKeys:function(){var e=function(e){if(e.preventDefault(),e.stopPropagation(),this._focusedCells&&this._focusedCells.length){var t=a(this.option("focusedElement"));e.target=this._focusedCells,this._showPopup=!0,this._cellClickAction({event:e,cellElement:a(this._focusedCells),cellData:this.getCellData(t)})}},t=function(e,t){e.preventDefault(),e.stopPropagation(),this._moveToCell(t,e.shiftKey)};return c(this.callBase(),{enter:e,space:e,downArrow:function(e){var l=this._getCellFromNextRow("next",e.shiftKey);t.call(this,e,l)},upArrow:function(e){var l=this._getCellFromNextRow("prev",e.shiftKey);t.call(this,e,l)},rightArrow:function(e){var l=this._getRightCell(e.shiftKey);t.call(this,e,l)},leftArrow:function(e){var l=this._getLeftCell(e.shiftKey);t.call(this,e,l)}})},_isRTL:function(){return this.option("rtlEnabled")},_getFocusedCell:function(){return this._$focusedCell||this._$dateTable.find("."+ue).eq(0)},_getAllFocusedCells:function(){return this._focusedCells||this._$dateTable.find("."+ue).eq(0)},_getCellFromNextRow:function(e){var t=this._$focusedCell;if(b(t)){var l=t.index(),a,i=t.parent()[e]().children().eq(l);return i=this._checkForViewBounds(i)}},_checkForViewBounds:function(e){return e.length||(e=this._$focusedCell),e},_getRightCell:function(e){if(b(this._$focusedCell)){var t,l=this._$focusedCell,a=this._getGroupCount(),i,n=(e?this._getCellCount():this._getTotalCellCount(a))-1,o=this._isRTL()?0:n,s=l.index(),r=this._isRTL()?"prev":"next";if(s===o||e&&this._isGroupEndCell(l)){var h=l.parent(),u=this._isRTL()?1:-1;t=h[r]().children().eq(s+u*n),t=this._checkForViewBounds(t)}else t=l[r]();return t}},_isGroupEndCell:function(e){var t=this._getCellCount(),l,a=e.index()%t;return this._isRTL()?0===a:a===t-1},_getLeftCell:function(e){if(b(this._$focusedCell)){var t,l=this._$focusedCell,a=this._getGroupCount(),i,n=(e?this._getCellCount():this._getTotalCellCount(a))-1,o=this._isRTL()?n:0,s=l.index(),r=this._isRTL()?"next":"prev";if(s===o||e&&this._isGroupStartCell(l)){var h=l.parent(),u=this._isRTL()?-1:1;t=h[r]().children().eq(s+u*n),t=this._checkForViewBounds(t)}else t=l[r]();return t}},_isGroupStartCell:function(e){var t=this._getCellCount(),l,a=e.index()%t;return this._isRTL()?a===t-1:0===a},_moveToCell:function(e,t){t=t&&this.option("allowMultipleCellSelection"),this._setFocusedCell(e,t),this._dateTableScrollable.scrollToElement(e)},_setFocusedCell:function(e,t){if(b(e)&&e.length){if(this._releaseFocusedCell(),this._focusedCells=[],t){e=this._correctCellForGroup(e);var l=this._getCellsBetween(e,this._$prevCell);this._focusedCells=l.toArray()}else this._focusedCells=[e.get(0)],this._$prevCell=e;var i=a(this._focusedCells);this._toggleFocusClass(!0,i),this.setAria("label","Add appointment",i),this._toggleFocusedCellClass(!0,e),this._$focusedCell=e;var n=this.getFocusedCellData();this.option("selectedCellData",n),this._selectionChangedAction({selectedCellData:n})}},_correctCellForGroup:function(e){var t=this._$focusedCell,l=this._getGroupIndexByCell(e),a=this._getGroupIndexByCell(t),i=this._hasAllDayClass(e)!==this._hasAllDayClass(t);return a!==l||i?t:e},_getCellsBetween:function(e,t){var l=this._hasAllDayClass(t),i=this._getCells(l),n=i.index(e),o=i.index(t);if(n>o){var s=n;n=o,o=s}if(i=i.slice(n,o+1),this._getGroupCount()>1){var r=[],h=this._getGroupIndexByCell(e);d(i,function(e,t){var l=this._getGroupIndexByCell(a(t));h===l&&r.push(t)}.bind(this)),i=a(r)}return i},_hasAllDayClass:function(e){return e.hasClass(Z)},_getGroupIndexByCell:function(e){var t=this._getCellCount(),l=e.index()+1,a;return Math.ceil(l/t)},_toggleFocusedCellClass:function(e,t){var l;(t&&t.length?t:this._focusTarget()).toggleClass("dx-scheduler-focused-cell",e)},_releaseFocusedCell:function(e){e=e||a(this._focusedCells),b(e)&&e.length&&(this._toggleFocusClass(!1,e),this._toggleFocusedCellClass(!1,e),this.setAria("label",void 0,e)),this.option("selectedCellData",[])},_focusInHandler:function(e){if(a(e.target).is(this._focusTarget())&&!1!==this._isCellClick){delete this._isCellClick,delete this._contextMenuHandled,this.callBase.apply(this,arguments);var t=this._getFocusedCell();this._setFocusedCell(t)}},_focusOutHandler:function(){this.callBase.apply(this,arguments),this._contextMenuHandled||this._releaseFocusedCell()},_focusTarget:function(){return this.$element()},_activeStateUnit:"."+ue+", ."+Z,_getDefaultOptions:function(){return c(this.callBase(),{currentDate:new Date,intervalCount:1,startDate:null,firstDayOfWeek:void 0,startDayHour:0,endDayHour:24,hoursInterval:.5,activeStateEnabled:!0,hoverStateEnabled:!0,groups:[],showAllDayPanel:!0,allDayExpanded:!1,onCellClick:null,crossScrollingEnabled:!1,dataCellTemplate:null,timeCellTemplate:null,resourceCellTemplate:null,dateCellTemplate:null,allowMultipleCellSelection:!0,indicatorTime:new Date,indicatorUpdateInterval:5*p("minute"),shadeUntilCurrentTime:!0,groupOrientation:"horizontal",selectedCellData:[],groupByDate:!1})},_optionChanged:function(e){switch(e.name){case"dateCellTemplate":case"resourceCellTemplate":case"dataCellTemplate":case"timeCellTemplate":case"startDayHour":case"endDayHour":case"hoursInterval":case"firstDayOfWeek":case"currentDate":case"startDate":this._cleanWorkSpace();break;case"groups":this._cleanView(),this._removeAllDayElements(),this._initGrouping(),this.repaint();break;case"groupOrientation":this._initGroupedStrategy(),this._createAllDayPanelElements(),this._removeAllDayElements(),this._cleanWorkSpace(),this._toggleGroupByDateClass();break;case"showAllDayPanel":this._isVerticalGroupedWorkSpace()?(this._cleanView(),this._removeAllDayElements(),this._initGrouping(),this.repaint()):this._toggleAllDayVisibility();break;case"allDayExpanded":this._changeAllDayVisibility(),this.notifyObserver("allDayPanelToggled"),this._attachTablesEvents(),this.headerPanelOffsetRecalculate(),this._updateScrollable();break;case"onSelectionChanged":this._createSelectionChangedAction();break;case"onCellClick":this._createCellClickAction();break;case"onCellContextMenu":this._attachContextMenuEvent();break;case"intervalCount":this._cleanWorkSpace(),this._toggleWorkSpaceCountClass(),this._toggleFixedScrollableClass();break;case"groupByDate":this._cleanWorkSpace(),this._toggleGroupByDateClass();break;case"crossScrollingEnabled":this._toggleHorizontalScrollClass(),this._dateTableScrollable.option(this._dateTableScrollableConfig());break;case"width":this.callBase(e),this._dimensionChanged();break;case"allowMultipleCellSelection":case"selectedCellData":break;default:this.callBase(e)}},_cleanWorkSpace:function(){this._cleanView(),this._toggleGroupedClass(),this._toggleWorkSpaceWithOddCells(),this._renderView()},_init:function(){this.callBase(),this._initGrouping(),this._toggleHorizontalScrollClass(),this._toggleWorkSpaceCountClass(),this._toggleGroupByDateClass(),this._toggleWorkSpaceWithOddCells(),this._toggleWorkSpaceOverlappingClass(),this.$element().addClass(B).addClass(this._getElementClass())},_initGrouping:function(){this._initGroupedStrategy(),this._toggleGroupingDirectionClass(),this._toggleGroupByDateClass()},_initGroupedStrategy:function(){var e,t="vertical"===(this.option("groups").length?this.option("groupOrientation"):this._getDefaultGroupStrategy())?G:k;this._groupedStrategy=new t(this)},_getDefaultGroupStrategy:function(){return"horizontal"},_isVerticalGroupedWorkSpace:function(){return!!this.option("groups").length&&"vertical"===this.option("groupOrientation")},_isHorizontalGroupedWorkSpace:function(){return!!this.option("groups").length&&"horizontal"===this.option("groupOrientation")},_toggleHorizontalScrollClass:function(){this.$element().toggleClass(R,this.option("crossScrollingEnabled"))},_toggleGroupByDateClass:function(){this.$element().toggleClass(V,this.isGroupedByDate())},_toggleWorkSpaceCountClass:function(){this.$element().toggleClass(E,this._isWorkSpaceWithCount())},_isWorkSpaceWithCount:function(){return this.option("intervalCount")>1},_toggleWorkSpaceWithOddCells:function(){this.$element().toggleClass(O,this._isWorkspaceWithOddCells())},_isWorkspaceWithOddCells:function(){return.5===this.option("hoursInterval")},_toggleWorkSpaceOverlappingClass:function(){this.$element().toggleClass(M,this._isWorkSpaceWithOverlapping())},_isWorkSpaceWithOverlapping:function(){return null!==this.invoke("getMaxAppointmentsPerCell")},_toggleGroupingDirectionClass:function(){this.$element().toggleClass(P,this._isVerticalGroupedWorkSpace())},_getRealGroupOrientation:function(){return this._isVerticalGroupedWorkSpace()?"vertical":"horizontal"},_getTimePanelClass:function(){return F},_getDateTableClass:function(){return he},_getDateTableRowClass:function(){return ce},_getDateTableCellClass:function(e,t){var l=ue+" "+te+" "+le;return this._needApplyLastGroupCellClass()?this._groupedStrategy.addAdditionalGroupCellClasses(l,t+1,e,t):l},_needApplyLastGroupCellClass:function(){return!0},_getGroupRowClass:function(){return oe},_getGroupHeaderClass:function(e){var t=se;return this._groupedStrategy.addAdditionalGroupCellClasses(t,e+1)},_getGroupHeaderContentClass:function(){return re},_initWorkSpaceUnits:function(){this._$headerPanel=a("<table>"),this._$thead=a("<thead>").appendTo(this._$headerPanel),this._$fixedContainer=a("<div>").addClass(K),this._$allDayContainer=a("<div>").addClass(U),this._initAllDayPanelElements(),this._createAllDayPanelElements(),this._$timePanel=a("<table>").addClass(this._getTimePanelClass()),this._$dateTable=a("<table>"),this._$groupTable=a("<table>").addClass(W)},_initAllDayPanelElements:function(){this._allDayTitles=[],this._allDayTables=[],this._allDayPanels=[]},_createAllDayPanelElements:function(){var e=this._getGroupCount();if(this._isVerticalGroupedWorkSpace()&&0!==e)for(var t=0;t<e;t++){var l=a("<div>").addClass(J).text(g.format("dxScheduler-allDay"));this._allDayTitles.push(l),this._$allDayTable=a("<table>"),this._allDayTables.push(this._$allDayTable),this._$allDayPanel=a("<div>").addClass(N).append(this._$allDayTable),this._allDayPanels.push(this._$allDayPanel)}else this._$allDayTitle=a("<div>").addClass(J).text(g.format("dxScheduler-allDay")).appendTo(this.$element()),this._$allDayTable=a("<table>"),this._$allDayPanel=a("<div>").addClass(N).append(this._$allDayTable)},_initDateTableScrollable:function(){var e=a("<div>").addClass("dx-scheduler-date-table-scrollable");this._dateTableScrollable=this._createComponent(e,$,this._dateTableScrollableConfig())},_dateTableScrollableConfig:function(){var e={useKeyboard:!1,useNative:!1,bounceEnabled:!1,updateManually:!0,pushBackValue:0};return this._needCreateCrossScrolling()&&(e=c(e,this._createCrossScrollingConfig())),e},_createCrossScrollingConfig:function(){var e,t,l={direction:"both"};return l.onStart=function(l){this._headerScrollable&&(e=this._headerScrollable.option("onScroll"),this._headerScrollable.option("onScroll",void 0)),this._sidebarScrollable&&(t=this._sidebarScrollable.option("onScroll"),this._sidebarScrollable.option("onScroll",void 0))}.bind(this),l.onScroll=function(e){this._sidebarScrollable&&this._sidebarScrollable.scrollTo({top:e.scrollOffset.top}),this._headerScrollable&&this._headerScrollable.scrollTo({left:e.scrollOffset.left})}.bind(this),l.onEnd=function(){this.notifyObserver("updateResizableArea",{}),this._headerScrollable&&this._headerScrollable.option("onScroll",e),this._sidebarScrollable&&this._sidebarScrollable.option("onScroll",t)}.bind(this),l},_createWorkSpaceElements:function(){this.option("crossScrollingEnabled")?this._createWorkSpaceScrollableElements():this._createWorkSpaceStaticElements()},_createWorkSpaceStaticElements:function(){this._isVerticalGroupedWorkSpace()?(this._dateTableScrollable.$content().append(this._$allDayContainer,this._$groupTable,this._$timePanel,this._$dateTable),this.$element().append(this._$fixedContainer,this._$headerPanel,this._dateTableScrollable.$element())):(this._dateTableScrollable.$content().append(this._$timePanel,this._$dateTable),this.$element().append(this._$fixedContainer,this._$headerPanel,this._$allDayContainer,this._$allDayPanel,this._dateTableScrollable.$element()))},_createWorkSpaceScrollableElements:function(){this.$element().append(this._$fixedContainer),this._createHeaderScrollable(),this._createSidebarScrollable(),this.$element().append(this._dateTableScrollable.$element()),this._headerScrollable.$content().append(this._$headerPanel),this._dateTableScrollable.$content().append(this._$dateTable),this._isVerticalGroupedWorkSpace()?(this._dateTableScrollable.$content().prepend(this._$allDayContainer),this._sidebarScrollable.$content().append(this._$groupTable,this._$timePanel)):this._headerScrollable.$content().append(this._$allDayContainer,this._$allDayPanel),this._sidebarScrollable.$content().append(this._$timePanel)},_createHeaderScrollable:function(){var e=a("<div>").addClass("dx-scheduler-header-scrollable").appendTo(this.$element());this._headerScrollable=this._createComponent(e,$,this._headerScrollableConfig())},_headerScrollableConfig:function(){var e,t;return{useKeyboard:!1,showScrollbar:!1,direction:"horizontal",useNative:!1,updateManually:!0,bounceEnabled:!1,pushBackValue:0,onStart:function(t){e=this._dateTableScrollable.option("onScroll"),this._dateTableScrollable.option("onScroll",void 0)}.bind(this),onScroll:function(e){this._dateTableScrollable.scrollTo({left:e.scrollOffset.left})}.bind(this),onEnd:function(t){this._dateTableScrollable.option("onScroll",e)}.bind(this)}},_createSidebarScrollable:function(){var e,t=a("<div>").addClass("dx-scheduler-sidebar-scrollable").appendTo(this.$element());this._sidebarScrollable=this._createComponent(t,$,{useKeyboard:!1,showScrollbar:!1,direction:"vertical",useNative:!1,updateManually:!0,bounceEnabled:!1,pushBackValue:0,onStart:function(t){e=this._dateTableScrollable.option("onScroll"),this._dateTableScrollable.option("onScroll",void 0)}.bind(this),onScroll:function(e){this._dateTableScrollable.scrollTo({top:e.scrollOffset.top})}.bind(this),onEnd:function(t){this._dateTableScrollable.option("onScroll",e)}.bind(this)})},_visibilityChanged:function(e){e&&this._isVerticalGroupedWorkSpace()&&this._setHorizontalGroupHeaderCellsHeight(),e&&this._needCreateCrossScrolling()&&this._setTableSizes()},_attachTableClasses:function(){if(this._addTableClass(this._$dateTable,this._getDateTableClass()),this._isVerticalGroupedWorkSpace())for(var e=this._getGroupCount(),t=0;t<e;t++)this._addTableClass(this._allDayTables[t],q);else this._addTableClass(this._$allDayTable,q)},_attachHeaderTableClasses:function(){this._addTableClass(this._$headerPanel,ae)},_addTableClass:function(e,t){e&&!e.hasClass(t)&&e.addClass(t)},_setTableSizes:function(){this._attachTableClasses();var e=this.getCellWidth();e<this.getCellMinWidth()&&(e=this.getCellMinWidth());var t=this.getWorkSpaceMinWidth(),l,a=e*this._$headerPanel.find("tr").last().find("th").length;a<t&&(a=t),this._$headerPanel.width(a),this._$dateTable.width(a),this._$allDayTable&&this._$allDayTable.width(a),this._attachHeaderTableClasses(),this._isVerticalGroupedWorkSpace()&&this._setHorizontalGroupHeaderCellsHeight()},getWorkSpaceMinWidth:function(){return this._groupedStrategy.getWorkSpaceMinWidth()},_dimensionChanged:function(){this.option("crossScrollingEnabled")&&this._setTableSizes(),this.headerPanelOffsetRecalculate(),this._cleanCellDataCache(),this._cleanAllowedPositions()},_needCreateCrossScrolling:function(){return this.option("crossScrollingEnabled")},_getElementClass:D,_getRowCount:D,_getCellCount:D,_initMarkup:function(){this._initWorkSpaceUnits(),this._initDateTableScrollable(),this._createWorkSpaceElements(),this.callBase(),this.option("crossScrollingEnabled")||(this._attachTableClasses(),this._attachHeaderTableClasses()),this._toggleGroupedClass(),this._toggleFixedScrollableClass(),this._renderView(),this._attachEvents(),this._setFocusOnCellByOption(this.option("selectedCellData"))},_render:function(){this.callBase(),this._renderDateTimeIndication(),this._setIndicationUpdateInterval()},_toggleGroupedClass:function(){this.$element().toggleClass(H,this._getGroupCount()>0)},_toggleFixedScrollableClass:D,_renderView:function(){if(this._setFirstViewDate(),this._applyCellTemplates(this._renderGroupHeader()),this._renderDateHeader(),this._renderTimePanel(),this._isVerticalGroupedWorkSpace())for(var e=this._getGroupCount(),t=0;t<e;t++)this._renderAllDayPanel(t);this._renderDateTable(),this._renderAllDayPanel(),this._updateGroupTableHeight(),this._shader=new I},_updateGroupTableHeight:function(){this._isVerticalGroupedWorkSpace()&&h.hasWindow()&&this._setHorizontalGroupHeaderCellsHeight()},_renderDateTimeIndication:D,_setIndicationUpdateInterval:D,_refreshDateTimeIndication:D,_setFocusOnCellByOption:function(e){var t=[];this._releaseFocusedCell();for(var l=0;l<e.length;l++){var a=e[l].groups,i=this.option("groups").length&&a?this._getGroupIndexByResourceId(a):0,n=!!e[l].allDay,o=this.getCoordinatesByDate(e[l].startDate,i,n),s=this._getCellByCoordinates(o,i);b(s)&&(this._toggleFocusClass(!0,s),t.push(s.get(0)))}this._focusedCells=t},_getGroupIndexByResourceId:function(e){for(var t=this.option("groups"),l=Object.keys(e)[0],a=e[l],i=this.invoke("createResourcesTree",t),n=0,o=0;o<i.length;o++)i[o].name===l&&i[o].value===a&&(n=i[o].leafIndex);return n},_setFirstViewDate:function(){var e=b(this._firstDayOfWeek())?this._firstDayOfWeek():_.firstDayOfWeekIndex();this._firstViewDate=s.getFirstWeekDate(this._getViewStartByOptions(),e),this._setStartDayHour(this._firstViewDate)},_getViewStartByOptions:function(){if(this.option("startDate")){for(var e=s.trimTime(this._getStartViewDate()),t=this.option("currentDate"),l=e.getTime()<=t.getTime()?1:-1,a=new Date(e.getTime()+this._getIntervalDuration()*l);!this._dateInRange(t,e,a,l);)e=a,a=new Date(e.getTime()+this._getIntervalDuration()*l);return l>0?e:a}return this.option("currentDate")},_getHeaderDate:function(){return this.getStartViewDate()},_getStartViewDate:function(){return this.option("startDate")},_dateInRange:function(e,t,l,a){return a>0?s.dateInRange(e,t,new Date(l.getTime()-1)):s.dateInRange(e,l,t,"date")},_getIntervalDuration:function(){return p("day")*this.option("intervalCount")},_setStartDayHour:function(e){var t=this.option("startDayHour");b(t)&&e.setHours(t,t%1*60,0,0)},_firstDayOfWeek:function(){return this.option("firstDayOfWeek")},_attachEvents:function(){this._createSelectionChangedAction(),this._attachClickEvent(),this._attachContextMenuEvent()},_attachClickEvent:function(){var e=this,t=this._createAction((function(t){e._pointerDownHandler(t.event)}));this._createCellClickAction();var l="."+ue+",."+Z,i=this.$element();n.off(i,fe),n.off(i,ye),n.on(i,fe,(function(e){T.isMouseEvent(e)&&e.which>1?e.preventDefault():t({event:e})})),n.on(i,ye,l,(function(t){var l=a(t.target);e._cellClickAction({event:t,cellElement:u(l),cellData:e.getCellData(l)})}))},_createCellClickAction:function(){var e=this;this._cellClickAction=this._createActionByOption("onCellClick",{afterExecute:function(t){e._moveToClosestNonStub(t.args[0].event)}})},_createSelectionChangedAction:function(){this._selectionChangedAction=this._createActionByOption("onSelectionChanged")},_moveToClosestNonStub:function(e){var t=a(e.target);this._showPopup&&this._hasFocusClass(t)&&(delete this._showPopup,this._showAddAppointmentPopup(t))},_pointerDownHandler:function(e){var t=a(e.target);t.hasClass(ue)||t.hasClass(Z)?(this._isCellClick=!0,t.hasClass("dx-scheduler-focused-cell")?this._showPopup=!0:this._setFocusedCell(t)):this._isCellClick=!1},_showAddAppointmentPopup:function(e){var t=this.getCellData(e.first()),l=this.getCellData(e.last()),a={startDate:t.startDate,endDate:l.endDate};b(l.allDay)&&(a.allDay=l.allDay),c(a,l.groups),this.notifyObserver("showAddAppointmentPopup",a)},_attachContextMenuEvent:function(){this._createContextMenuAction();var e="."+ue+",."+Z,t=this.$element(),l=T.addNamespace(x.name,this.NAME);n.off(t,l,e),n.on(t,l,e,this._contextMenuHandler.bind(this))},_contextMenuHandler:function(e){var t=a(e.target);this._contextMenuAction({event:e,cellElement:u(t),cellData:this.getCellData(t)}),this._contextMenuHandled=!0},_createContextMenuAction:function(){this._contextMenuAction=this._createActionByOption("onCellContextMenu")},_getGroupHeaderContainer:function(){return this._isVerticalGroupedWorkSpace()?this._$groupTable:this._$thead},_getDateHeaderContainer:function(){return this._$thead},_renderGroupHeader:function(){var e=this._getGroupHeaderContainer(),t=this._getGroupCount(),l=[];if(t){var a=this._makeGroupRows(this.option("groups"),this.option("groupByDate"));this._attachGroupCountAttr(t,a),e.append(a.elements),l=a.cellTemplates}else this._detachGroupCountAttr();return l},_applyCellTemplates:function(e){e.forEach((function(e){e()}))},_detachGroupCountAttr:function(){var e=this._groupedStrategy.getGroupCountAttr();this.$element().removeAttr(e.attr)},_attachGroupCountAttr:function(e,t){var l=this._groupedStrategy.getGroupCountAttr(e,t);this.$element().attr(l.attr,l.count)},headerPanelOffsetRecalculate:function(){if(this.option("resourceCellTemplate")||this.option("dateCellTemplate")){var e=this.getHeaderPanelHeight(),t=this.invoke("getHeaderHeight"),l=this.supportAllDayRow()&&this.option("showAllDayPanel")?this._groupedStrategy.getAllDayTableHeight():0;e&&this._headerScrollable&&this._headerScrollable.$element().height(e+l),e&&this._dateTableScrollable.$element().css({paddingBottom:l+e+"px",marginBottom:-1*(parseInt(e,10)+l)+"px"}),e&&this._sidebarScrollable&&this._sidebarScrollable.$element().css({paddingBottom:l+e+"px",marginBottom:-1*(parseInt(e,10)+l)+"px"}),this._$allDayTitle&&this._$allDayTitle.css("top",t+e+"px")}},_makeGroupRows:function(e,t){var l=this._isVerticalGroupedWorkSpace()?A.VERTICAL:A.HORIZONTAL;return A.makeGroupedTable(l,e,{groupHeaderRowClass:this._getGroupRowClass(),groupRowClass:this._getGroupRowClass(),groupHeaderClass:this._getGroupHeaderClass.bind(this),groupHeaderContentClass:this._getGroupHeaderContentClass()},this._getCellCount()||1,this.option("resourceCellTemplate"),this._getGroupCount(),t)},_getDateHeaderTemplate:function(){return this.option("dateCellTemplate")},_renderDateHeader:function(){var e,t,l=this._getDateHeaderContainer(),i=a("<tr>").addClass(ne),n=this._getCellCount(),o=this._getDateHeaderTemplate(),s=this._calculateHeaderCellRepeatCount(),r=[],h=this.option("groupByDate")?this._getGroupCount():1,u;if(this.option("groupByDate")){for(e=0;e<n;e++){var c;this._renderDateHeaderTemplate(i,e,e*s,o,r).attr("colSpan",h)}l.prepend(i)}else{for(t=0;t<s;t++)for(e=0;e<n;e++)this._renderDateHeaderTemplate(i,e,t*s+e,o,r);l.append(i)}return this._applyCellTemplates(r),i},_renderDateHeaderTemplate:function(e,t,l,i,n){var o=this._getHeaderText(t),s=a("<th>").addClass(this._getHeaderPanelCellClass(t)).attr("title",o);return i&&i.render?n.push(i.render.bind(i,{model:{text:o,date:this._getDateByIndex(t)},index:l,container:u(s)})):s.text(o),e.append(s),s},_getHeaderPanelCellClass:function(e){var t=ie+" "+te;return this._groupedStrategy.addAdditionalGroupCellClasses(t,e+1)},_calculateHeaderCellRepeatCount:function(){return this._groupedStrategy.calculateHeaderCellRepeatCount()},_renderAllDayPanel:function(e){var t=this._getCellCount();this._isVerticalGroupedWorkSpace()||(t*=this._getGroupCount()||1);var l=this._renderTableBody({container:this._allDayPanels.length?u(this._allDayTables[e]):u(this._$allDayTable),rowCount:1,cellCount:t,cellClass:this._getAllDayPanelCellClass.bind(this),rowClass:Q,cellTemplate:this.option("dataCellTemplate"),getCellData:this._getAllDayCellData.bind(this),groupIndex:e},!0);this._toggleAllDayVisibility(),this._applyCellTemplates(l)},_getAllDayPanelCellClass:function(e,t){var l=Z+" "+te;return this._groupedStrategy.addAdditionalGroupCellClasses(l,t+1)},_getAllDayCellData:function(e,t,l,a){var i=this._getDateByCellIndexes(t,l),n={startDate:i=s.trimTime(i),endDate:new Date(i.getTime()+$e),allDay:!0},o=this._getCellGroups(a||this._getGroupIndex(t,l));o.length&&(n.groups={});for(var r=0;r<o.length;r++)n.groups[o[r].name]=o[r].id;return{key:me,value:n}},_toggleAllDayVisibility:function(){var e=this.option("showAllDayPanel");this._$allDayPanel.toggle(e),this._$allDayTitle&&this._$allDayTitle.toggleClass(j,!e),this.$element().toggleClass(X,e),this._changeAllDayVisibility(),this._updateScrollable()},_changeAllDayVisibility:function(){this.$element().toggleClass(Y,!this.option("allDayExpanded")&&this.option("showAllDayPanel"))},_updateScrollable:function(){this._dateTableScrollable.update(),this._headerScrollable&&this._headerScrollable.update(),this._sidebarScrollable&&this._sidebarScrollable.update()},_renderTimePanel:function(){var e=this._groupedStrategy.calculateTimeCellRepeatCount();this._renderTableBody({container:u(this._$timePanel),rowCount:this._getTimePanelRowCount()*e,cellCount:1,cellClass:this._getTimeCellClass.bind(this),rowClass:L,cellTemplate:this.option("timeCellTemplate"),getCellText:this._getTimeText.bind(this),getCellDate:this._getTimeCellDate.bind(this),groupCount:this._getGroupCount(),allDayElements:this._insertAllDayRowsIntoDateTable()?this._allDayTitles:void 0})},_getTimePanelRowCount:function(){return this._getCellCountInDay()},_getCellCountInDay:function(){return Math.ceil(this._calculateDayDuration()/this.option("hoursInterval"))},_calculateDayDuration:function(){return this.option("endDayHour")-this.option("startDayHour")},_getTimeCellClass:function(e){var t=z+" "+le;return this._groupedStrategy.addAdditionalGroupCellClasses(t,e,e)},_getTimeText:function(e){var t=this._getTimeCellDate(e),l;return e%this._getRowCount()%2==0?_.format(t,"shorttime"):""},_getTimeCellDate:function(e){var t=new Date(this.getStartViewDate()),l=Math.round(this.getCellDuration()),a=this._calculateDayDuration()/this.option("hoursInterval");return t.setMilliseconds(t.getMilliseconds()+l*(e%a)),t},_renderDateTable:function(){var e=this._getGroupCount();this._renderTableBody({container:u(this._$dateTable),rowCount:this._getTotalRowCount(e),cellCount:this._getTotalCellCount(e),cellClass:this._getDateTableCellClass.bind(this),rowClass:this._getDateTableRowClass(),cellTemplate:this.option("dataCellTemplate"),getCellData:this._getCellData.bind(this),allDayElements:this._insertAllDayRowsIntoDateTable()?this._allDayPanels:void 0,groupCount:e,groupByDate:this.option("groupByDate")}),this._attachTablesEvents()},_insertAllDayRowsIntoDateTable:function(){return this._groupedStrategy.insertAllDayRowsIntoDateTable()},_getTotalCellCount:function(e){return this._groupedStrategy.getTotalCellCount(e)},_getTotalRowCount:function(){return this._groupedStrategy.getTotalRowCount()},_getCellData:function(e,t,l){var a=this._prepareCellData(t,l,e);return{key:me,value:a}},_prepareCellData:function(e,t){var l=this._getDateByCellIndexes(e,t),a,i={startDate:l,endDate:this.calculateEndDate(l),allDay:this._getTableAllDay()},n=this._getCellGroups(this._getGroupIndex(e,t));n.length&&(i.groups={});for(var o=0;o<n.length;o++)i.groups[n[o].name]=n[o].id;return i},_getGroupIndex:function(e,t){return this._groupedStrategy.getGroupIndex(e,t)},_getTableAllDay:function(){return!1},calculateEndDate:function(e){var t=new Date(e);return t.setMilliseconds(t.getMilliseconds()+Math.round(this._getInterval())),t},_getGroupCount:function(){for(var e=this.option("groups"),t=0,l=0,a=e.length;l<a;l++)l?t*=e[l].items.length:t=e[l].items.length;return t},_getPathToLeaf:function(e){var t,l;function a(e,t){for(var l=0;l<e.length;l++){if(e[l].leafIndex===t)return e[l];var i=a(e[l].children,t);if(i)return i}}function i(e,t){return(t=t||[]).push(e.value),e.parent&&i(e.parent,t),t}return i(a(this.invoke("createResourcesTree",this.option("groups")),e)).reverse()},_getCellGroups:function(e){var t=[];if(this._getGroupCount()){var l=this.option("groups");if(e<0)return;for(var a=this._getPathToLeaf(e),i=0;i<l.length;i++)t.push({name:l[i].name,id:a[i]})}return t},_attachTablesEvents:function(){this._attachTableEvents(this._getDateTable()),this._attachTableEvents(this._getAllDayTable())},_attachTableEvents:function(e){var t,l,o=this,s=!1;n.off(e,De),n.off(e,be),n.off(e,Se),n.off(e,Te),n.on(e,De,"td",{itemSizeFunc:function(e){return t||(t=e.get(0).getBoundingClientRect().height),l||(l=e.get(0).getBoundingClientRect().width),{width:l,height:t}}},(function(e){o._$currentTableTarget&&o._$currentTableTarget.removeClass(ge),o._$currentTableTarget=a(e.target),o._$currentTableTarget.addClass(ge)})),n.on(e,be,"td",(function(e){a(e.target).removeClass(ge),t=0,l=0})),n.on(e,Te,"td",(function(e){T.isMouseEvent(e)&&1===e.which&&(s=!0,o.$element().addClass(ee),n.off(i.getDocument(),ve),n.on(i.getDocument(),ve,(function(){s=!1,o.$element().removeClass(ee)})))})),n.on(e,Se,"td",(function(e){s&&o._dateTableScrollable&&!o._dateTableScrollable.option("scrollByContent")&&(e.preventDefault(),e.stopPropagation(),o._moveToCell(a(e.target),!0))}))},_getDateTables:function(){return this._$dateTable.add(this._$allDayTable)},_getDateTable:function(){return this._$dateTable},_getAllDayTable:function(){return this._$allDayTable},_getInterval:function(){return void 0===this._interval&&(this._interval=this.option("hoursInterval")*ke),this._interval},_getHeaderText:function(e){return _.format(this._getDateByIndex(e),this._getFormat())},_getDateByIndex:f,_getFormat:f,_calculateCellIndex:function(e,t){return this._groupedStrategy.calculateCellIndex(e,t)},_renderTableBody:function(e,t){var l=[];return t?l=A.makeTable(e):this._applyCellTemplates(A.makeTable(e)),l},_removeAllDayElements:function(){this._$allDayTable&&this._$allDayTable.remove(),this._$allDayTitle&&this._$allDayTitle.remove()},_cleanView:function(){this._cleanCellDataCache(),this._cleanAllowedPositions(),this._$thead.empty(),this._$dateTable.empty(),this._shader&&this._shader.clean(),this._$timePanel.empty(),this._$allDayTable&&this._$allDayTable.empty(),this._$groupTable.empty(),delete this._hiddenInterval,delete this._interval},_clean:function(){n.off(i.getDocument(),ve),this.callBase()},getWorkArea:function(){return this._dateTableScrollable.$content()},getScrollable:function(){return this._dateTableScrollable},getScrollableScrollTop:function(){return this._dateTableScrollable.scrollTop()},getGroupedScrollableScrollTop:function(e){return this._groupedStrategy.getScrollableScrollTop(e)},getScrollableScrollLeft:function(){return this._dateTableScrollable.scrollLeft()},getScrollableOuterWidth:function(){return this._dateTableScrollable.scrollWidth()},getScrollableContainer:function(){return this._dateTableScrollable._container()},getHeaderPanelHeight:function(){return this._$headerPanel&&this._$headerPanel.outerHeight(!0)},getTimePanelWidth:function(){return this._$timePanel&&this._$timePanel.get(0).getBoundingClientRect().width},getGroupTableWidth:function(){return this._$groupTable?this._$groupTable.outerWidth():0},getWorkSpaceLeftOffset:function(){return this._groupedStrategy.getLeftOffset()},getGroupedStrategy:function(){return this._groupedStrategy},_getCellCoordinatesByIndex:function(e){var t=Math.floor(e/this._getRowCount()),l;return{cellIndex:t,rowIndex:e-this._getRowCount()*t}},_getDateByCellIndexes:function(e,t,l){t=l?t:this._patchCellIndex(t);var a=this.getStartViewDate(),i=new Date(a.getTime()+this._getMillisecondsOffset(e,t)+this._getOffsetByCount(t));return i.setTime(i.getTime()+s.getTimezonesDifference(a,i)),i},_patchCellIndex:function(e){return this.isGroupedByDate()&&(e=Math.floor(e/this._getGroupCount())),e},_getOffsetByCount:function(){return 0},_getMillisecondsOffset:function(e,t){return this._getInterval()*this._calculateCellIndex(e,t)+this._calculateHiddenInterval(e,t)},_calculateHiddenInterval:function(e,t){var l;return t%this._getCellCount()*this._getHiddenInterval()},_getHiddenInterval:function(){return void 0===this._hiddenInterval&&(this._hiddenInterval=$e-this.getVisibleDayDuration()),this._hiddenInterval},_getIntervalBetween:function(e,t){var l=this.getStartViewDate(),a=this.option("startDayHour")*ke,i=s.getTimezonesDifference(l,e),n=e.getTime()-l.getTime()-i,o=this._getDaysOfInterval(n,a),r=this._getWeekendsCount(o),h=(o-r)*$e;return t||(h=n-o*this._getHiddenInterval()-r*this.getVisibleDayDuration()),h},_getWeekendsCount:function(){return 0},_getDaysOfInterval:function(e,t){return Math.floor((e+t)/$e)},_getGroupIndexes:function(e){var t=[];if(e&&this.option("groups").length){var l=this.invoke("createResourcesTree",this.option("groups"));t=this.invoke("getResourceTreeLeaves",l,e)}return t},_updateIndex:function(e){return e*this._getRowCount()},_getDroppableCell:function(){return this._getDateTables().find("."+ge)},_getWorkSpaceWidth:function(){return this._needCreateCrossScrolling()?this._$dateTable.get(0).getBoundingClientRect().width:this.$element().get(0).getBoundingClientRect().width-this.getTimePanelWidth()},_getCellPositionByIndex:function(e,t,l){var a=this._getCellCoordinatesByIndex(e),i=this._getCellByCoordinates(a,t,l),n=this._getCellPosition(i);return this.setCellDataCache(a,t,i),n&&(n.rowIndex=a.rowIndex,n.cellIndex=a.cellIndex),n},_getCellPosition:function(e){var t=e.position();return this.option("rtlEnabled")&&(t.left+=e.get(0).getBoundingClientRect().width),t},_getCellByCoordinates:function(e,t,l){var a=this._groupedStrategy.prepareCellIndexes(e,t,l);return this._$dateTable.find("tr").eq(a.rowIndex).find("td").eq(a.cellIndex)},_getCells:function(e){var t=e?Z:ue;return this.$element().find("."+t)},_setHorizontalGroupHeaderCellsHeight:function(){var e=this._$dateTable.get(0).getBoundingClientRect().height;this._$groupTable.outerHeight(e)},_getDateTableBorder:function(){return 1},_getDateTableBorderOffset:function(){return 2*this._getDateTableBorder()},_getGroupHeaderCellsContent:function(){return this.$element().find("."+re)},_getGroupHeaderCells:function(){return this.$element().find("."+se)},_getScrollCoordinates:function(e,t,l){var a=l||new Date(this.option("currentDate")),i=this.option("startDayHour"),n=this.option("endDayHour");return e<i&&(e=i),e>=n&&(e=n-1),a.setHours(e,t,0,0),this.getCoordinatesByDate(a)},setCellDataCache:function(e,t,l){var a=this.getCellDataCache(),i=this.getCellData(l),n;a[JSON.stringify({rowIndex:e.rowIndex,cellIndex:e.cellIndex,groupIndex:t})]=i},setCellDataCacheAlias:function(e,t){var l=JSON.stringify({rowIndex:e.rowIndex,cellIndex:e.cellIndex,groupIndex:e.groupIndex}),a=JSON.stringify({top:t.top,left:t.left}),i=this.getCellDataCache();i[l]&&(i[a]=i[l])},getCellDataCache:function(e){return this._cache||(this._cache={}),e?this._cache[e]:this._cache},_cleanCellDataCache:function(){delete this._cache},_cleanAllowedPositions:function(){delete this._maxAllowedVerticalPosition,delete this._maxAllowedPosition},supportAllDayRow:function(){return!0},keepOriginalHours:function(){return!1},getFocusedCellData:function(){var e=this._getAllFocusedCells(),t=[];if(e.length>1)t=this._getMultipleCellsData(e);else{var l=this.getCellData(e);l&&t.push(l)}return t},_getMultipleCellsData:function(e){for(var t=[],l=0;l<e.length;l++)t.push(o.data(e[l],me));return t},getCellData:function(e){var t=e[0]?o.data(e[0],me):void 0;return c(!0,{},t)},_getHorizontalMax:function(e){return e=this.option("groupByDate")?this._getGroupCount()-1:e,this._groupedStrategy.getHorizontalMax(e)},getCoordinatesByDate:function(e,t,l){t=t||0;var a=this.getCellIndexByDate(e,l),i=this._getCellPositionByIndex(a,t,l),n=this.getPositionShift(l?0:this.getTimeShift(e)),o=this._getHorizontalMax(t,e),s;if(!i)throw S.Error("E1039");return{cellPosition:i.left+n.cellPosition,top:i.top+n.top,left:i.left+n.left,rowIndex:i.rowIndex,cellIndex:i.cellIndex,hMax:o,vMax:this.getVerticalMax(t),groupIndex:t}},getVerticalMax:function(e){return this._groupedStrategy.getVerticalMax(e)},_getOffsetByAllDayPanel:function(e){return this._groupedStrategy._getOffsetByAllDayPanel(e)},_getGroupTop:function(e){return this._groupedStrategy._getGroupTop(e)},isGroupedByDate:function(){return this.option("groupByDate")&&this._isHorizontalGroupedWorkSpace()&&this._getGroupCount()>0},getCellIndexByDate:function(e,t){var l=t?864e5:this._getInterval(),a=this._getIntervalBetween(e,t),i=Math.floor(a/l);return t&&(i=this._updateIndex(i)),i<0&&(i=0),i},getPositionShift:function(e){return{top:e*this.getCellHeight(),left:0,cellPosition:0}},getTimeShift:function(e){var t=this.getCellDuration(),l=new Date(e);return l.setHours(this.option("startDayHour"),0,0,0),(e.getTime()-l.getTime())%t/t},getCoordinatesByDateInGroup:function(e,t,l){var a=this._getGroupIndexes(t),i=[];if(a.length)for(var n=0;n<a.length;n++)i.push(this.getCoordinatesByDate(e,a[n],l));else i.push(this.getCoordinatesByDate(e,0,l));return i},getDroppableCellIndex:function(){var e=this._getDroppableCell(),t=e.parent(),l;return t.index()*t.find("td").length+e.index()},getDataByDroppableCell:function(){var e=this.getCellData(this._getDroppableCell());return{date:e.startDate,allDay:e.allDay,groups:e.groups}},getDateRange:function(){return[this.getStartViewDate(),this.getEndViewDate()]},getCellWidth:function(){var e=this._getCells().first().get(0);return e&&e.getBoundingClientRect().width},getCellMinWidth:function(){return 75},getRoundedCellWidth:function(e,t,l){if(e<0)return 0;var i,n=0,o=this.$element().find("."+this._getDateTableRowClass()).eq(0).find("."+ue),s=this._getCellCount()*e;l=l||this._getCellCount(),r.isDefined(t)||(t=s);for(var h=t;h<s+l;h++)n+=a(o).eq(h).get(0).getBoundingClientRect().width;return n/(s+l-t)},getCellHeight:function(){var e=this._getCells().first().get(0);return e&&e.getBoundingClientRect().height},getAllDayHeight:function(){var e=this._getCells(!0).first().get(0);return this.option("showAllDayPanel")&&e&&e.getBoundingClientRect().height||0},getAllDayOffset:function(){return this._groupedStrategy.getAllDayOffset()},getMaxAllowedPosition:function(){if(!this._maxAllowedPosition){var e=this.option("rtlEnabled");this._maxAllowedPosition=[],this._$dateTable.find("tr").first().find("td:nth-child("+this._getCellCount()+"n)").each(function(t,l){var i=a(l).position().left;e||(i+=a(l).get(0).getBoundingClientRect().width),this._maxAllowedPosition.push(Math.round(i))}.bind(this))}return this._maxAllowedPosition},getMaxAllowedVerticalPosition:function(){if(!this._maxAllowedVerticalPosition){var e=this;this._maxAllowedVerticalPosition=[];var t=this._getRowCount();this._$dateTable.find("tr:nth-child("+t+"n)").each((function(t,l){var i=a(l).position().top+a(l).get(0).getBoundingClientRect().height;e._maxAllowedVerticalPosition.push(Math.round(i))}))}return this._maxAllowedVerticalPosition},getFixedContainer:function(){return this._$fixedContainer},getAllDayContainer:function(){return this._$allDayContainer},getCellIndexByCoordinates:function(e,t){var l=this._getTotalCellCount(this._getGroupCount()),a=Math.floor(this._getWorkSpaceWidth()/l),i=t?this.getAllDayHeight():this.getCellHeight(),n=this._isRTL()||this.option("crossScrollingEnabled")?0:this.getWorkSpaceLeftOffset(),o=Math.floor(e.top/i),s=Math.floor((e.left+5-n)/a);return this._isRTL()&&(s=l-s-1),l*o+s},getStartViewDate:function(){return this._firstViewDate},getEndViewDate:function(){var e=this.getDateOfLastViewCell(),t=this.calculateEndViewDate(e);return this._adjustEndViewDateByDaylightDiff(e,t)},calculateEndViewDate:function(e){return new Date(e.getTime()+this.getCellDuration())},_adjustEndViewDateByDaylightDiff:function(e,t){var l=this.invoke("getDaylightOffset",e,t)*p("minute")||0,a=new Date(t.getTime()-l);return new Date(a.getTime()-p("minute"))},getDateOfLastViewCell:function(){var e=this._getRowCount()-1,t=this._getCellCount();return this.option("groupByDate")?t=t*this._getGroupCount()-1:t-=1,this._getDateByCellIndexes(e,t,!0)},getCellDuration:function(){return 36e5*this.option("hoursInterval")},getIntervalDuration:function(e){return e?p("day"):this.getCellDuration()},getVisibleDayDuration:function(){return this.option("hoursInterval")*this._getCellCountInDay()*ke},getGroupBounds:function(e){var t=this._getCellCount(),l=this._getCells(),a=this.getCellWidth(),i=this._groupedStrategy.getGroupBoundsOffset(t,l,a,e);if(this._isRTL()){var n=i.left;i.left=i.right-2*a,i.right=n+2*a}return i},needRecalculateResizableArea:function(){return this._isVerticalGroupedWorkSpace()&&0!==this.getScrollable().scrollTop()},getCellDataByCoordinates:function(e,t){var l=JSON.stringify({top:e.top,left:e.left}),a=this.getCellDataCache(l);if(a)return a;var i=this._getCells(t),n=this.getCellIndexByCoordinates(e,t),o=i.eq(n);return this.getCellData(o)},getVisibleBounds:function(){var e={},t=this.getScrollable().$element(),l=this.getCellHeight(),a=this.getScrollableScrollTop()/l,i=a+t.height()/l;return e.top={hours:Math.floor(a*this.option("hoursInterval"))+this.option("startDayHour"),minutes:a%2?30:0},e.bottom={hours:Math.floor(i*this.option("hoursInterval"))+this.option("startDayHour"),minutes:Math.floor(i)%2?30:0},e},updateScrollPosition:function(e){e=this.invoke("convertDateByTimezone",e);var t=this.getVisibleBounds(),l=e.getHours(),a=e.getMinutes();this.needUpdateScrollPosition(l,a,t,e)&&this.scrollToTime(l,a,e)},needUpdateScrollPosition:function(e,t,l){var a=!1;return(e<l.top.hours||e>l.bottom.hours)&&(a=!0),e===l.top.hours&&t<l.top.minutes&&(a=!0),e===l.bottom.hours&&t>l.top.minutes&&(a=!0),a},getGroupWidth:function(e){var t=this._getCellCount()*this.getCellWidth(),l=this.getMaxAllowedPosition(),a=l[e];return l.length&&a&&(t=this._isRTL()?a-l[e+1]:0===e?a:a-l[e-1]),t},restoreScrollTop:function(){this.$element().scrollTop(0)},scrollToTime:function(e,t,l){var a=this.getStartViewDate(),i=this.getEndViewDate();if(l<a||l>i)S.log("W1008",l);else{var n=this._getScrollCoordinates(e,t,l),o=this.getScrollable();o.scrollBy({top:n.top-o.scrollTop(),left:0})}},getDistanceBetweenCells:function(e,t){var l=0;return this.$element().find("."+this._getDateTableRowClass()).first().find("."+ue).each((function(i){if(i<e||i>t)return!0;l+=a(this).get(0).getBoundingClientRect().width})),l},getDateTableWidth:function(){return this._$dateTable.get(0).getBoundingClientRect().width},applyGroupButtonOffset:function(){return!1},_supportCompactDropDownAppointments:function(){return!0},_formatWeekday:function(e){return Ge(e)},_formatWeekdayAndDay:function(e){return Ge(e)+" "+_.format(e,"day")}}).include(y);l.exports=Ae}

