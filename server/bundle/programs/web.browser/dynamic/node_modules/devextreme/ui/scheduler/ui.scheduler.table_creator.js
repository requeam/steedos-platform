function module(e,t,l){"use strict";var a=e("../../core/renderer"),r=e("../../core/dom_adapter"),n=e("../../core/element_data"),o=e("../../core/utils/type"),s=e("../../core/utils/dom").getPublicElement,d="tr",u={VERTICAL:"vertical",HORIZONTAL:"horizontal",insertAllDayRow:function(e,t,l){if(e[l]){var n=e[l].find(d);n.length||(n=a(r.createElement(d))).append(e[l].get(0)),t.appendChild(n.get?n.get(0):n)}},makeTable:function(e){var t,l=r.createElement("tbody"),u=[],i=e.groupCount?e.rowCount/e.groupCount:e.rowCount,p=0,c=e.allDayElements,m=e.groupIndex,C=e.rowCount;a(e.container).append(l),c&&(this.insertAllDayRow(c,l,0),p++);for(var h=0;h<C;h++){t=r.createElement(d),l.appendChild(t);var g=(h+1)%i==0;e.rowClass&&(t.className=e.rowClass);for(var f=0;f<e.cellCount;f++){var v=r.createElement("td"),w,T,D;if(t.appendChild(v),e.cellClass&&(o.isFunction(e.cellClass)?v.className=e.cellClass(h,f):v.className=e.cellClass),e.getCellData&&(T=(w=e.getCellData(v,h,f,m)).key,D=w.value,T&&n.data(v,T,D)),e.cellTemplate&&e.cellTemplate.render){var R={model:{text:e.getCellText?e.getCellText(h,f):"",date:e.getCellDate?e.getCellDate(h):void 0},container:s(a(v)),index:h*e.cellCount+f};D&&(D.startDate&&(R.model.startDate=D.startDate),D.endDate&&(R.model.endDate=D.endDate),D.groups&&(R.model.groups=D.groups),D.allDay&&(R.model.allDay=D.allDay)),u.push(e.cellTemplate.render.bind(e.cellTemplate,R))}else e.getCellText&&(v.innerHTML="<div>"+e.getCellText(h,f)+"</div>")}c&&g&&(this.insertAllDayRow(c,l,p),p++)}return u},makeGroupedTable:function(e,t,l,a,r,n,o){var s=[];return s=e===this.VERTICAL?this._makeVerticalGroupedRows(t,l,r,n):this._makeHorizontalGroupedRows(t,l,a,r,o)},makeGroupedTableFromJSON:function(e,t,l){var a,n=[],o=0,s=(l=l||{}).cellTag||"td",u=l.childrenField||"children",i=l.titleField||"title",p=l.groupTableClass,c=l.groupRowClass,m=l.groupCellClass,C=l.groupCellCustomContent;function h(){a=r.createElement("table"),p&&(a.className=p)}function g(e){return e[u]?e[u].length:0}function f(e,t,l,a){var n={element:r.createElement(s),childCount:t};m&&(n.element.className=m);var o=r.createTextNode(e);return"function"==typeof C?C(n.element,o,l,a):n.element.appendChild(o),n}function v(e){for(var t=0;t<e.length;t++){var l=g(e[t]),a=f(e[t][i],l,t,e[t]);n[o]||(n[o]=[]),n[o].push(a),l?v(e[t][u]):o++}}function w(){n.forEach((function(e){var t=r.createElement(d);c&&(t.className=c);for(var l=[],n=e.length-1;n>=0;n--){var o=e[n+1],s=e[n].childCount;o&&o.childCount&&(s*=o.childCount),l.push(s)}l.reverse(),e.forEach((function(e,a){l[a]&&e.element.setAttribute("rowSpan",l[a]),t.appendChild(e.element)})),a.appendChild(t)}))}return h(),v(t),w(),a},_makeVerticalGroupedRows:function(e,t,l,r){var n,o=[],s=1,d=[],u=function(e){e.template&&o.push(e.template)};for(n=0;n<e.length;n++){n>0&&(s=e[n-1].items.length*s);var i=this._makeGroupedRowCells(e[n],s,t,l);i.forEach(u),d.push(i)}var p=[],c=d.length,m=d[c-1].length;for(n=0;n<m;n++)p.push(a("<tr>").addClass(t.groupHeaderRowClass));for(n=c-1;n>=0;n--)for(var C=d[n].length,h=m/C,g=0;g<C;g++){var f,v;p[g*h].prepend(d[n][g].element.attr("rowSpan",h))}return{elements:p,cellTemplates:o}},_makeHorizontalGroupedRows:function(e,t,l,r,n){for(var o=1,s=e.length,d=[],u=[],i=n?l:1,p=function(e){return e.template&&u.push(e.template),e.element},c=0;c<s;c++){c>0&&(o=e[c-1].items.length*o);var m=this._makeGroupedRowCells(e[c],o,t,r,i);d.push(a("<tr>").addClass(t.groupRowClass).append(m.map(p)))}for(var C=d[s-1].find("th").length,h=0;h<s;h++){var g=d[h].find("th"),f=C/g.length;n||(f*=l),(f>1&&1===i||n&&s>1)&&g.attr("colSpan",f)}return{elements:d,cellTemplates:u}},_makeGroupedRowCells:function(e,t,l,r,n){t*=n=n||1;for(var d=[],u=e.items,i=u.length,p=0;p<t;p++)for(var c=0;c<i;c++){var m=a("<div>"),C={},h;if(r&&r.render){var g={model:u[c],container:s(m),index:p*i+c};e.data&&(g.model.data=e.data[c]),C.template=r.render.bind(r,g)}else m.text(u[c].text),m=a("<div>").append(m);m.addClass(l.groupHeaderContentClass),h=o.isFunction(l.groupHeaderClass)?l.groupHeaderClass(c):l.groupHeaderClass,C.element=a("<th>").addClass(h).append(m),d.push(C)}return d}};l.exports=u}

