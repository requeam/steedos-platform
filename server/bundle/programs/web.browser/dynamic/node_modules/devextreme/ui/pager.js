function module(e,t,i){"use strict";var a=e("../core/renderer"),s=e("../events/core/events_engine"),n=e("../core/class"),o=e("../core/utils/string"),d=e("../core/component_registrator"),p=e("../core/utils/common"),h=e("../core/utils/iterator").each,g=e("../core/utils/type"),r=e("../core/utils/extend").extend,l=e("../events/click"),u=e("../events/pointer"),_=e("../localization/message"),c=e("./widget/ui.widget"),x=e("./select_box"),v=e("./number_box"),f=e("../events/utils"),C=4,P="dx-pager",b="dx-page",m="dx-pages",S="dx-light-mode",z="dx-light-pages",$="dx-page-index",I="dx-pages-count",w="dx-selection",W="dx-separator",N="dx-page-sizes",E="dx-page-size",M="dx-navigate-button",T="dx-prev-button",L="dx-next-button",B="dx-info",k="dx-info-text",y="dx-button-disable",H=n.inherit({ctor:function(e,t){var i=this;this.index=t,this._$page=a("<div>").text(e).addClass("dx-page")},value:function(e){var t=this;if(!g.isDefined(e)){var i=this._$page.text();return g.isNumeric(i)?parseInt(i):i}this._$page.text(e)},element:function(){return this._$page},select:function(e){this._$page.toggleClass("dx-selection",e)},render:function(e,t){t?this._$page.prependTo(e):this._$page.appendTo(e)}}),A=c.inherit({_getDefaultOptions:function(){return r(this.callBase(),{visible:!0,pagesNavigatorVisible:"auto",pageIndex:1,maxPagesCount:10,pageCount:10,totalCount:0,pageSize:5,showPageSizes:!0,pageSizes:[5,10],hasKnownLastPage:!0,showNavigationButtons:!1,showInfo:!1,infoText:_.getFormatter("dxPager-infoText"),pagesCountText:_.getFormatter("dxPager-pagesCountText"),rtlEnabled:!1,lightModeEnabled:!1,pageIndexChanged:p.noop,pageSizeChanged:p.noop})},_toggleVisibility:function(e){var t=this.$element();t&&t.css("display",e?"":"none")},_getPages:function(e,t){var i,a,s=[],n=!this.option("hasKnownLastPage");if(t>0||n)if(t<=this.option("maxPagesCount")){for(a=1;a<=t;a++)s.push(new H(a,a-1));n&&s.push(new H(">",a-1))}else{for(s.push(new H(1,0)),i=e?e.value()-e.index:1,a=1;a<=4;a++)s.push(new H(i+a,a));s.push(new H(t,5)),n&&s.push(new H(">",5))}return s},_getPageByValue:function(e){var t,i,a=this;for(i=0;i<this._pages.length;i++)if((t=this._pages[i]).value()===e)return t},_processSelectedPage:function(e,t,i){var a,s=this,n=!1;this._pages&&(h(this._pages,(function(e,i){t===i.value()&&(n=!0)})),n||(this.selectedPage=null)),g.isDefined(this.selectedPage)?t===i&&i>e&&5!==this.selectedPage.index&&(this.selectedPage.index=5):t>4&&t<i&&(a=i-4<t?4-(i-t)+1:2,this.selectedPage=new H(t,a))},_selectPageByValue:function(e){var t,i,a,s,n=this,o=this._getPageByValue(e),d=this._pages,p=d.length;if(g.isDefined(o)){if(i=this._pages[o.index-1],(a=this._pages[o.index+1])&&">"===a.value()&&(s=a,a=void 0,p--,d.pop()),this.selectedPage&&this.selectedPage.select(!1),o.select(!0),this.selectedPage=o,a&&a.value()-e>1)if(0!==o.index)for(i.value(e+1),this._pages.splice(o.index,1),this._pages.splice(o.index-1,0,o),this._pages[o.index].index=o.index,o.index=o.index-1,t=o.index-1;t>0;t--)this._pages[t].value(this._pages[t+1].value()-1);else for(t=0;t<p-1;t++)this._pages[t].value(t+1);if(i&&e-i.value()>1)if(o.index!==p-1)for(a.value(e-1),this._pages.splice(o.index,1),this._pages.splice(o.index+1,0,o),this._pages[o.index].index=o.index,o.index=o.index+1,t=o.index+1;t<p-1;t++)this._pages[t].value(this._pages[t-1].value()+1);else for(t=1;t<=p-2;t++)this._pages[p-1-t].value(this._pages[p-1].value()-t);s&&d.push(s)}},_nextPage:function(e){var t=this.option("pageIndex"),i=this.option("pageCount");g.isDefined(t)&&(t="next"===e?++t:--t)>0&&t<=i&&this.option("pageIndex",t)},_wrapClickAction:function(e){var t=this;return function(i){if("dxpointerup"===i.type)t._pointerUpHappened=!0;else if(t._pointerUpHappened)return void(t._pointerUpHappened=!1);e({event:i})}},_renderPages:function(e){var t,i,n=this,o=e.length,d=n._createAction((function(e){var t=e.event,i=a(t.target).text(),s=">"===i?n.option("pageCount")+1:Number(i);n.option("pageIndex",s)}));o>1&&(n._pageClickHandler=n._wrapClickAction(d),s.on(n._$pagesChooser,f.addNamespace([u.up,l.name],n.Name+"Pages"),".dx-page",n._pageClickHandler));for(var p=0;p<o;p++)(i=e[p]).render(n._$pagesChooser,n.option("rtlEnabled")),n.setAria({role:"button",label:"Page "+i.value()},i.element()),e[p+1]&&e[p+1].value()-i.value()>1&&(t=a("<div>").text(". . .").addClass("dx-separator"),n.option("rtlEnabled")?t.prependTo(n._$pagesChooser):t.appendTo(n._$pagesChooser))},_calculateLightPagesWidth:function(e,t){return Number(e.css("minWidth").replace("px",""))+10*t.toString().length},_renderLightPages:function(){var e,t,i=this,n=this.option("pageCount"),o=this.option("pageIndex"),d=i._createAction((function(){i.option("pageIndex",n)})),p=this.option("pagesCountText"),h=a("<div>").addClass("dx-light-pages").appendTo(this._$pagesChooser);t=a("<div>").addClass("dx-page-index").appendTo(h),i._pageIndexEditor=i._createComponent(t,v,{value:o,min:1,max:n,width:i._calculateLightPagesWidth(t,n),onValueChanged:function(e){i.option("pageIndex",e.value)}}),a("<span>").text(p).addClass("dx-info-text dx-info").appendTo(h),e=a("<span>").addClass("dx-pages-count").text(n),s.on(e,f.addNamespace(l.name,i.Name+"PagesCount"),(function(e){d({event:e})})),e.appendTo(h),i.setAria({role:"button",label:"Navigates to the last page"},e)},_renderPagesChooser:function(){var e=this,t=this.option("lightModeEnabled"),i=this.option("pagesNavigatorVisible"),s=this.$element();this._$pagesChooser&&this._$pagesChooser.remove(),i&&(this._pages&&0===this._pages.length?this.selectedPage=null:(this._$pagesChooser=a("<div>").addClass("dx-pages").appendTo(s),"auto"===i&&this._$pagesChooser.css("visibility",1===this.option("pageCount")?"hidden":""),t||this._renderInfo(),this._renderNavigateButton("prev"),t?this._renderLightPages():this._renderPages(this._pages),this._renderNavigateButton("next"),this._updatePagesChooserWidth()))},_renderPageSizes:function(){var e,t,i,n=this,o=n.option("pageSizes"),d=o&&o.length,p=n.option("pageSize"),h=n._createAction((function(e){var i=e.event;t=parseInt(a(i.target).text()),n.option("pageSize",t)}));for(s.on(n._$pagesSizeChooser,f.addNamespace(l.name,n.Name+"PageSize"),".dx-page-size",(function(e){h({event:e})})),e=0;e<d;e++)i=a("<div>").text(o[e]).addClass("dx-page-size"),n.setAria({role:"button",label:"Display "+o[e]+" items on page"},i),p===o[e]&&i.addClass("dx-selection"),n._$pagesSizeChooser.append(i)},_calculateLightPageSizesWidth:function(e){return Number(this._$pagesSizeChooser.css("minWidth").replace("px",""))+10*Math.max.apply(Math,e).toString().length},_renderLightPageSizes:function(){var e,t=this,i=t.option("pageSizes");e=a("<div>").appendTo(t._$pagesSizeChooser),t._pageSizeEditor=t._createComponent(e,x,{dataSource:i,value:t.option("pageSize"),onSelectionChanged:function(e){t.option("pageSize",e.selectedItem)},width:t._calculateLightPageSizesWidth(i)})},_renderPagesSizeChooser:function(){var e=this,t=this.option("pageSizes"),i=this.option("showPageSizes"),s=t&&t.length,n=this.$element();this._$pagesSizeChooser&&this._$pagesSizeChooser.remove(),i&&s&&(this._$pagesSizeChooser=a("<div>").addClass("dx-page-sizes").appendTo(n),this.option("lightModeEnabled")?this._renderLightPageSizes():this._renderPageSizes(),this._pagesSizeChooserWidth=this._$pagesSizeChooser.width())},_renderInfo:function(){var e=this.option("infoText");this.option("showInfo")&&g.isDefined(e)&&(this._$info=a("<div>").css("display",this._isInfoHide?"none":"").addClass("dx-info").text(o.format(e,this.selectedPage&&this.selectedPage.value(),this.option("pageCount"),this.option("totalCount"))).appendTo(this._$pagesChooser),this._isInfoHide||(this._infoWidth=this._$info.outerWidth(!0)))},_renderNavigateButton:function(e){var t,i=this,n=i._createAction((function(){i._nextPage(e)}));(i.option("showNavigationButtons")||i.option("lightModeEnabled"))&&(t=a("<div>").addClass("dx-navigate-button"),s.on(t,f.addNamespace([u.up,l.name],i.Name+"Pages"),i._wrapClickAction(n)),i.setAria({role:"button",label:"prev"===e?"Previous page":" Next page"},t),i.option("rtlEnabled")?(t.addClass("prev"===e?"dx-next-button":"dx-prev-button"),t.prependTo(this._$pagesChooser)):(t.addClass("prev"===e?"dx-prev-button":"dx-next-button"),t.appendTo(this._$pagesChooser)))},_renderContentImpl:function(){this.$element().toggleClass("dx-light-mode",this.option("lightModeEnabled")),this._toggleVisibility(this.option("visible")),this._updatePageSizes(!0),this._updatePages(!0)},_initMarkup:function(){var e=this.$element();e.addClass("dx-pager");var t=a("<div>").addClass("dx-page");this._$pagesChooser=a("<div>").addClass("dx-pages").append(t).appendTo(e)},_render:function(){this.option().lightModeEnabled=!1,this.callBase(),this._updateLightMode()},_updatePageSizes:function(e){var t=this.option("lightModeEnabled"),i=this.option("pageSize"),a=this.option("pageSizes");t&&this._pageSizeEditor&&this._pageSizeEditor.option({value:i,dataSource:a,width:this._calculateLightPageSizesWidth(a)}),t&&!e||this._renderPagesSizeChooser()},_updatePages:function(e){var t=this.option("pageCount"),i=this.option("pageIndex"),a=this.option("lightModeEnabled");a?this._pageIndexEditor&&this._pageIndexEditor.option({value:i,width:this._calculateLightPagesWidth(this._pageIndexEditor.$element(),t)}):(this._processSelectedPage(this.option("maxPagesCount"),i,t),this._pages=this._getPages(this.selectedPage,t),this._selectPageByValue(i)),a&&!e||this._renderPagesChooser(),this._updateButtonsState(i)},_isPageIndexInvalid:function(e,t){var i="next"===e,a=this.option("rtlEnabled");return a&&i||!a&&!i?t<=1:t>=this.option("pageCount")},_updateButtonsState:function(e){var t=this.$element().find(".dx-next-button"),i=this.$element().find(".dx-prev-button");t.toggleClass("dx-button-disable",this._isPageIndexInvalid("next",e)),i.toggleClass("dx-button-disable",this._isPageIndexInvalid("prev",e))},_optionChanged:function(e){switch(e.name){case"visible":this._toggleVisibility(e.value);break;case"pageIndex":var t=this.option("pageIndexChanged");t&&t(e.value),this._updatePages();break;case"maxPagesCount":case"pageCount":case"totalCount":case"hasKnownLastPage":case"pagesNavigatorVisible":case"showNavigationButtons":this._updatePages();break;case"pageSize":var i=this.option("pageSizeChanged");i&&i(e.value),this._updatePageSizes();break;case"pageSizes":this._updatePageSizes();break;case"lightModeEnabled":this._renderContentImpl(),!e.value&&this._updateLightMode();break;default:this._invalidate()}},_clean:function(){this._$pagesChooser&&s.off(this._$pagesChooser,f.addNamespace([u.up,l.name],this.Name+"Pages"),".dx-page",this._pageClickHandler),this.callBase()},_getMinPagerWidth:function(){var e,t;return(g.isDefined(this._pagesChooserWidth)?this._pagesChooserWidth:0)+(g.isDefined(this._pagesSizeChooserWidth)?this._pagesSizeChooserWidth:0)},_updatePagesChooserWidth:p.deferUpdater((function(){var e=this._pages&&this._pages.length>0?this._pages[this._pages.length-1]._$page.width():0;this._pagesChooserWidth=this._$pagesChooser.width()+e})),_updateLightMode:p.deferUpdater((function(){var e=this,t=this.$element().width(),i=g.isDefined(this._infoWidth)?this._infoWidth:0;p.deferRender((function(){e._isInfoHide&&t>e._getMinPagerWidth()+i&&(e._$info.show(),e._updatePagesChooserWidth(),e._isInfoHide=!1),!e._isInfoHide&&t>e._getMinPagerWidth()-i&&t<e._getMinPagerWidth()&&(e._$info.hide(),e._updatePagesChooserWidth(),e._isInfoHide=!0),p.deferUpdate((function(){p.deferRender((function(){e.option("lightModeEnabled")&&t>e._previousWidth?e.option("lightModeEnabled",!1):t<e._getMinPagerWidth()&&e.option("lightModeEnabled",!0),e._previousWidth=t}))}))}))})),_dimensionChanged:function(){this._updateLightMode()},getHeight:function(){return this.option("visible")?this.$element().outerHeight():0}});i.exports=A,d("dxPager",A)}

