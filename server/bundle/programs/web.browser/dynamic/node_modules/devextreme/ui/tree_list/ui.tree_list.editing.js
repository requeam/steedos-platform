function module(e){"use strict";e("./ui.tree_list.editor_factory");var t,i=g(e("../../core/renderer")),n,r=g(e("../widget/ui.errors")),o=e("../../core/utils/type"),l=e("../../core/utils/extend"),a=e("../../core/utils/deferred"),s,d=g(e("../../localization/message")),c,u=g(e("./ui.tree_list.core")),h,f=g(e("../grid_core/ui.grid_core.utils")),w,p=g(e("../grid_core/ui.grid_core.editing"));function g(e){return e&&e.__esModule?e:{default:e}}var v="dx-treelist-icon-container",x="dx-select-checkbox",_="insert",y=p.default.controllers.editing.inherit({_generateNewItem:function(e){var t=this.callBase(e);return t.data={key:e},t.children=[],t.level=0,t.parentKey=this.option("rootValue"),t},_needInsertItem:function(e,t,i,n){var r=e.key.parentKey;if(void 0!==r&&r!==this.option("rootValue")){var o=f.default.getIndexByKey(r,i);return o>=0&&this._dataController.isRowExpanded(r)&&i.splice(o+1,0,n),!1}return this.callBase.apply(this,arguments)},_isEditColumnVisible:function(){var e=this.callBase.apply(this,arguments),t=this.option("editing");return e||t&&t.allowAdding},_isDefaultButtonVisible:function(e,t){var i=this.callBase.apply(this,arguments),n=t.row;return"add"===e.name?this.allowAdding(t)&&n.rowIndex!==this._getVisibleEditRowIndex()&&!(n.removed||n.inserted):i},_getEditingButtons:function(e){var t=this.callBase.apply(this,arguments);return e.column.buttons||t.unshift(this._getButtonConfig("add",e)),t},_beforeSaveEditData:function(e){var t,i,n=this._dataController,l=this.callBase.apply(this,arguments);if(e&&"insert"!==e.type&&(t=(i=n&&n.store())&&i.key(),!(0,o.isDefined)(t)))throw r.default.Error("E1045");return l},addRowByRowIndex:function(e){var t,i=this.getController("data").getVisibleRows()[e];return this.addRow(i?i.key:void 0)},addRow:function(e){var t=this,i=this.callBase,n=this.getController("data");if(void 0!==e&&!n.isRowExpanded(e)){var r=new a.Deferred;return n.expandRow(e).done((function(){setTimeout((function(){i.call(t,e),r.resolve()}))})).fail(r.reject),r}i.call(t,e)},_initNewRow:function(e,t){var i=t.parentKey,n=this.getController("data"),r=n.dataSource(),o=r.createParentIdSetter();void 0===i&&(i=this.option("rootValue"),t.parentKey=i),o(e.data,i),this.callBase.apply(this,arguments)},allowAdding:function(e){return this._allowEditAction("allowAdding",e)},_needToCloseEditableCell:function(e){return this.callBase.apply(this,arguments)||e.closest(".dx-treelist-icon-container").length&&this.isEditing()}}),B=p.default.extenders.views.rowsView._rowClick,C=(0,l.extend)({},p.default.extenders.views.rowsView,{_renderCellCommandContent:function(e,t){var i=this._editingController,n=t.row&&i.isEditRow(t.row.rowIndex),r=t.isEditing||n;return!r&&this.callBase.apply(this,arguments)},_rowClick:function(e){var t=(0,i.default)(e.event.target);t.closest(".dx-select-checkbox").length||(t.closest(".dx-treelist-icon-container").length?this.callBase.apply(this,arguments):B.apply(this,arguments))}});u.default.registerModule("editing",{defaultOptions:function(){return(0,l.extend)(!0,p.default.defaultOptions(),{editing:{texts:{addRowToNode:d.default.format("dxTreeList-editingAddRowToNode")}}})},controllers:{editing:y},extenders:{controllers:(0,l.extend)(!0,{},p.default.extenders.controllers,{data:{changeRowExpand:function(){return this._editingController.refresh(),this.callBase.apply(this,arguments)}}}),views:{rowsView:C,headerPanel:p.default.extenders.views.headerPanel}}})}

