function module(t,e){"use strict";var i,o=h(t("../../events/core/events_engine")),n=t("../../core/utils/window"),a,s=h(t("./ui.grid_core.modules")),r,d=h(t("../widget/ui.errors")),u,c=h(t("../../core/utils/browser")),l=t("../../core/utils/storage"),f=t("../../core/utils/extend"),g=t("../../core/utils/iterator"),_=t("../../core/utils/type"),v=t("../../core/utils/deferred");function h(t){return t&&t.__esModule?t:{default:t}}var m=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,w=function t(e){e&&(0,g.each)(e,(function(i,o){var n;(0,_.isPlainObject)(o)||Array.isArray(o)?t(o):"string"==typeof o&&(n=m.exec(o))&&(e[i]=new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])))}))},S,p;e.StateStoringController=s.default.ViewController.inherit((S=function(t){var e="sessionStorage"===t.type?(0,l.sessionStorage)():(0,n.getWindow)().localStorage;if(!e)throw"file:"===(0,n.getWindow)().location.protocol&&c.default.msie?new Error("E1038"):new Error("E1007");return e},p=function(t){return(0,_.isDefined)(t.storageKey)?t.storageKey:"storage"},{_loadState:function(){var t=this.option("stateStoring");if("custom"===t.type)return t.customLoad&&t.customLoad();try{return JSON.parse(S(t).getItem(p(t)))}catch(e){d.default.log(e.message)}},_saveState:function(t){var e=this.option("stateStoring");if("custom"!==e.type)try{S(e).setItem(p(e),JSON.stringify(t))}catch(i){}else e.customSave&&e.customSave(t)},publicMethods:function(){return["state"]},isEnabled:function(){return this.option("stateStoring.enabled")},init:function(){var t=this;return t._state={},t._isLoaded=!1,t._isLoading=!1,t._windowUnloadHandler=function(){void 0!==t._savingTimeoutID&&t._saveState(t.state())},o.default.on((0,n.getWindow)(),"unload",t._windowUnloadHandler),t},isLoaded:function(){return this._isLoaded},isLoading:function(){return this._isLoading},load:function(){var t,e=this;return e._isLoading=!0,(t=(0,v.fromPromise)(e._loadState())).done((function(t){e._isLoaded=!0,e._isLoading=!1,e.state(t)})),t},state:function(t){var e=this;if(!arguments.length)return(0,f.extend)(!0,{},e._state);e._state=(0,f.extend)({},t),w(e._state)},save:function(){var t=this;clearTimeout(t._savingTimeoutID),t._savingTimeoutID=setTimeout((function(){t._saveState(t.state()),t._savingTimeoutID=void 0}),t.option("stateStoring.savingTimeout"))},optionChanged:function(t){var e=this;switch(t.name){case"stateStoring":this.isEnabled()&&!this.isLoading()&&this.load(),t.handled=!0;break;default:this.callBase(t)}},dispose:function(){clearTimeout(this._savingTimeoutID),o.default.off((0,n.getWindow)(),"unload",this._windowUnloadHandler)}}))}

