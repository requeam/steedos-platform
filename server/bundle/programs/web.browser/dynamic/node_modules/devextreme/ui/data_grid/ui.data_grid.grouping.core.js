function module(t,n){"use strict";var e,o=g(t("../../core/renderer")),r,i=g(t("../../core/class")),a,f=g(t("./ui.data_grid.core")),u=t("../../data/utils"),s=t("../../core/utils/deferred"),l,h,c,d,p;function g(t){return t&&t.__esModule?t:{default:t}}n.createOffsetFilter=function(t,n){var e,o,r,i,a,s=(0,u.normalizeSortingInfo)(n.group),l=[];for(e=0;e<t.length;e++){for(r=[],o=0;o<=e;o++)i=s[o].selector,e!==o||null!==t[o]&&!1!==t[o]&&!0!==t[o]?"<"===(a=[i,e===o?s[o].desc?">":"<":"=",t[o]])[1]?r.push([a,"or",[i,"=",null]]):r.push(a):!1===t[o]?r.push([i,"=",!!s[o].desc||null]):(t[o]?!s[o].desc:s[o].desc)?r.push([i,"<>",t[o]]):(r.push([i,"<>",null]),r.push([i,"=",null]));l.push(f.default.combineFilters(r))}return l=f.default.combineFilters(l,"or"),f.default.combineFilters([l,n.filter])},n.GroupingHelper=i.default.inherit((l=function(t,n){var e=t.hash;return e&&e[JSON.stringify(n)]},h=function(t,n){var e,o=0,r=t.length-1;if(!t.length)return 0;do{var i=r+o>>1;t[i].offset>n?r=i:o=i}while(r-o>1);for(e=o;e<=r&&!(t[e].offset>n);e++);return e},c=function(t,n){var e,o;for(n=n||[],o=0;o<t.length;o++)if((e=t[o]).data&&e.data.offset!==e.offset){e.offset=e.data.offset;for(var r=0;r<n.length;r++)n[r].offset=e.offset}t.sort((function(t,n){return t.offset-n.offset}))},d=function t(n,e,o){var r;for(r=0;r<n.length;r++)e+1>=o?n[r].children=[]:t(n[r].children,e+1,o)},p=function t(n,e,o){var r,i=0;if(e)if(o)for(r=0;r<e.length;r++)n.isGroupItemCountable(e[r])&&i++,i+=t(n,e[r].items,o-1);else i=e.length;return i},{ctor:function(t){this._dataSource=t,this.reset()},reset:function(){this._groupsInfo=[],this._totalCountCorrection=0},totalCountCorrection:function(){return this._totalCountCorrection},updateTotalItemsCount:function(t){this._totalCountCorrection=t||0},isGroupItemCountable:function(t){return!this._isVirtualPaging()||!t.isContinuation},_isVirtualPaging:function(){var t=this._dataSource.option("scrolling.mode");return"virtual"===t||"infinite"===t},itemsCount:function t(){var n,e=this._dataSource._dataSource,o=f.default.normalizeSortingInfo(e.group()||[]).length,t=p(this,e.items(),o);return t},foreachGroups:function(t,n,e,r,i){var a=this;function f(t,n,a,u){var l,h,d=[];function p(t,n,e,o){var r=n&&t(n,e);return r&&o.push(r),r}for(l=0;l<t.length;l++){if(u.push(t[l].data),!a&&!1===p(n,t[l].data,u,d))return!1;if((!t[l].data||t[l].data.isExpanded||e)&&((h=f(t[l].children,n,a,u))&&d.push(h),!1===h))return!1;if(a&&!1===p(n,t[l].data,u,d))return!1;t[l].data&&t[l].data.offset===t[l].offset||(r=!0),u.pop()}var g=i&&u.slice(0);return r&&s.when.apply(o.default,d).always((function(){c(t,g)}))}return f(this._groupsInfo,t,n,[])},findGroupInfo:function(t){var n,e,o=this,r=this._groupsInfo;for(n=0;r&&n<t.length;n++)r=(e=l(r,t[n]))&&e.children;return e&&e.data},addGroupInfo:function(t){var n,e,o,r=this,i=t.path,a=this._groupsInfo;for(o=0;o<i.length;o++)(e=l(a,i[o]))||(e={key:i[o],offset:t.offset,data:{offset:t.offset,isExpanded:!0,path:i.slice(0,o+1)},children:[]},n=h(a,t.offset),a.splice(n,0,e),a.hash=a.hash||{},a.hash[JSON.stringify(e.key)]=e),o===i.length-1&&(e.data=t,e.offset!==t.offset&&c(a)),a=e.children},allowCollapseAll:function(){return!0},refresh:function(t){var n,e=this,o=t.storeLoadOptions,r=(0,u.normalizeSortingInfo)(o.group||[]),i="_group"in this?(0,u.normalizeSortingInfo)(this._group||[]):r,a=Math.min(i.length,r.length);for(this._group=o.group,n=0;n<a;n++)if(i[n].selector!==r[n].selector){a=n;break}a?d(this._groupsInfo,0,a):this.reset()},handleDataLoading:function(){},handleDataLoaded:function(t,n){n(t)},handleDataLoadedCore:function(t,n){n(t)}}))}

