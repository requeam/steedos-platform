function module(e,t){"use strict";var i=e("../../core/utils/type").isNumeric,n=e("../../core/utils/extend").extend,a=e("../../core/utils/iterator").each,s=e("../../core/utils/type").isDefined,r=Math,u=r.round,o=r.abs,l=r.pow,c=a,f=e("../../core/utils/common").noop,h=e("./utils"),g=.3,d=h.normalizeEnum;function p(e){return e<0||e>1?void 0:e}function v(e){return e<0||e>1?g:e}function m(e,t,i){return e.some((function(e){return i&&!e.getOptions().ignoreEmptyPoints||e.getPointsByArg(t,!0).some((function(e){return e.hasValue()}))}))}function S(e,t,i,n,a,r,u){e.forEach((function(e){var o,l=u(t.indexOf(n),t.length),c=e.getPointsByArg(i,!0),f=p(e.getOptions().barPadding),h=e.getOptions().barWidth,g=b(l,a),d=a.width;-1!==l&&((s(f)||s(h))&&(d=(o=V(r,t.length,1-f,h)).width,g=b(l,o)),x(c,d,g))}))}function k(e,t,i){var n,a=[],s=[],r={},u=t.barWidth,o=t.barGroupWidth,l=e[0]&&e[0].getArgumentAxis().getTranslator().getInterval(),c=o?l>o?o:l:l*(1-v(t.barGroupPadding));e.forEach((function(e,t){var i,n=e.getStackName&&e.getStackName()||t.toString();for(i in e.pointsByArgument)-1===s.indexOf(i.valueOf())&&s.push(i.valueOf());-1===a.indexOf(n)&&(a.push(n),r[n]=[]),r[n].push(e)})),s.forEach((function(e){var a,s=[];for(n in r)m(r[n],e,t.equalBarWidth)&&s.push(n);for(n in a=V(c,s.length,u),r)S(r[n],s,e,n,a,c,i)}))}function V(e,t,i,n){var a,r;return n?(r=Math.min(n,u(e/t)),a=t>1?u((e-r*t)/(t-1)):0):s(i)?(r=u(e*i/t),a=u(t>1?(e-e*i)/(t-1):0)):(a=u(e/t*.2),r=u((e-a*(t-1))/t)),{width:r>1?r:1,spacing:a,middleIndex:t/2}}function b(e,t){return(e-t.middleIndex+.5)*t.width-(t.middleIndex-e-.5)*t.spacing}function x(e,t,i){c(e,(function(e,n){n.correctCoordinates({width:t,offset:i})}))}function O(e){return e>=0?"positive":"negative"}function z(e){return e.series.filter((function(e){return e.isVisible()}))}function A(e,t,i){var n,a;return((e.positive[t]||{})[i]||0)+(-(e.negative[t]||{})[i]||0)}function B(e,t,i){var n,a;return((e.positive[t]||{})[i]||0)+((e.negative[t]||{})[i]||0)}function P(e){return e?function(e,t){return t-e-1}:function(e){return e}}function y(e){return e[0]&&e[0].getArgumentAxis().getTranslator().isInverted()}function _(){var e=z(this);k(e,this._options,P(y(e)))}function j(){var e=this,t=this._options.negativesAsZeroes,i=z(this),a={positive:{},negative:{}},s={left:{},right:{}},r={};i.forEach((function(e){var i=e.getStackName(),u=!1;e._prevSeries=r[i],r[i]=e,e.holes=n(!0,{},s),e.getPoints().forEach((function(e,n,r){var o,l=e.initialValue,c=e.argument.valueOf(),f=l>=0?a.positive:a.negative;if(t&&l<0&&(f=a.positive,l=0,e.resetValue()),f[i]=f[i]||{},(o=f[i])[c]?(e.correctValue(o[c]),o[c]+=l):(o[c]=l,e.resetCorrection()),e.hasValue())u&&(u=!1,s.left[c]=(s.left[c]||0)+(e.value-(isFinite(e.minValue)?e.minValue:0)),e._skipSetLeftHole=!0);else{var h=r[n-1];!u&&h&&h.hasValue()&&(c=h.argument.valueOf(),h._skipSetRightHole=!0,s.right[c]=(s.right[c]||0)+(h.value-(isFinite(h.minValue)?h.minValue:0))),u=!0}}))})),i.forEach((function(e){var t=e.holes;e.getPoints().forEach((function(e){var i=e.argument.valueOf();e.resetHoles(),!e._skipSetLeftHole&&e.setHole(t.left[i]||s.left[i]&&0,"left"),!e._skipSetRightHole&&e.setHole(t.right[i]||s.right[i]&&0,"right"),e._skipSetLeftHole=null,e._skipSetRightHole=null}))})),this._stackKeepers=a,i.forEach((function(e){e.getPoints().forEach((function(t){var i=t.argument.valueOf(),n=e.getStackName(),r=A(a,n,i),u=B(a,n,i);t.setPercentValue(r,u,s.left[i],s.right[i])}))}))}function E(){var e=this,t=z(e),i=e._stackKeepers,n={positive:{},negative:{}};c(t,(function(t,a){var s=a.getOptions().minBarSize,r=a.getValueAxis().getTranslator(),u=s&&r.getMinBarSize(s),o=a.getStackName();c(a.getPoints(),(function(t,a){if(a.hasValue()){var s,l,c,f=a.initialValue,h=a.argument.valueOf();e.fullStacked&&(f=f/A(i,o,h)||0),l=O(s=r.checkMinBarSize(f,u,a.value)),(c=n[l][o]=n[l][o]||{})[h]?(a.minValue=c[h],c[h]+=s):c[h]=s,a.value=c[h]}}))})),e.fullStacked&&H(t,n)}function H(e,t){c(e,(function(e,n){var a=n.getStackName?n.getStackName():"default";c(n.getPoints(),(function(e,n){var s=A(t,a,n.argument.valueOf());n.value=n.value/s,i(n.minValue)&&(n.minValue=n.minValue/s)}))}))}function D(){c(this.series,(function(e,t){var i=t.getOptions().minBarSize,n=t.getValueAxis().getTranslator(),a=i&&n.getMinBarSize(i);a&&c(t.getPoints(),(function(e,t){t.hasValue()&&(t.value=n.checkMinBarSize(t.initialValue,a))}))}))}function N(){var e=z(this);k(e,{barWidth:null,equalBarWidth:!0,barGroupPadding:.3},P(y(e)))}function w(){var e=z(this);if(e.length){var t,i,n,a,s,f=this._options,h=e[0].getArgumentAxis().getTranslator(),g=e[0].getValueAxis().getTranslator(),d=h.getCanvasVisibleArea(),p=g.getCanvasVisibleArea(),v=r.min(d.max-d.min,p.max-p.min),m=l(f.minBubbleSize,2),S=l(v*f.maxBubbleSize,2),k=(v*f.maxBubbleSize+f.minBubbleSize)/2,V=1/0,b=-1/0;c(e,(function(e,t){c(t.getPoints(),(function(e,t){b=b>t.size?b:t.size,V=V<t.size?V:t.size}))})),a=b-V,s=o(S-m),c(e,(function(e,l){c(l.getPoints(),(function(e,l){b===V?t=u(k):(n=o(l.size-V)/a,i=s*n+m,t=u(r.sqrt(i))),l.correctCoordinates(t)}))}))}}function M(e){var t=this;switch(this.type=d(e.type),this.pane=e.pane,this.series=[],this.updateOptions(e),this.type){case"bar":this.adjustSeriesDimensions=_,this.updateSeriesValues=D;break;case"rangebar":this.adjustSeriesDimensions=_;break;case"fullstackedbar":this.fullStacked=!0,this.adjustSeriesDimensions=_,this.adjustSeriesValues=j,this.updateSeriesValues=E;break;case"stackedbar":this.adjustSeriesDimensions=_,this.adjustSeriesValues=j,this.updateSeriesValues=E;break;case"fullstackedarea":case"fullstackedline":case"fullstackedspline":case"fullstackedsplinearea":this.fullStacked=!0,this.adjustSeriesValues=j;break;case"stackedarea":case"stackedsplinearea":case"stackedline":case"stackedspline":this.adjustSeriesValues=j;break;case"candlestick":case"stock":this.adjustSeriesDimensions=N;break;case"bubble":this.adjustSeriesDimensions=w}}t.SeriesFamily=M,M.prototype={constructor:M,adjustSeriesDimensions:f,adjustSeriesValues:f,updateSeriesValues:f,updateOptions:function(e){this._options=e},dispose:function(){this.series=null},add:function(e){var t=this.type;this.series=h.map(e,(function(e){return e.type===t?e:null}))}}}

