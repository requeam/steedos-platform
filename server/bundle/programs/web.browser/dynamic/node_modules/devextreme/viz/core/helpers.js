function module(n,e){"use strict";var t=n("../../core/utils/extend").extend,a=n("../../core/utils/window"),i=n("../../core/utils/common").noop,o=!a.hasWindow();function r(){this.reset()}function s(n,e){return n!==e?t({},n,e):t({},n)}function h(n,e){return n!==e?n.concat(e):n.slice()}function p(n){n._totalChangesOrder=n._optionChangesOrder.concat(n._layoutChangesOrder,n._customChangesOrder)}function u(n){var e=this.prototype,t=n.code;e["_change_"+t]=n.handler,n.isThemeDependent&&e._themeDependentChanges.push(t),n.option&&(e._optionChangesMap[n.option]=t),(n.isOptionChange?e._optionChangesOrder:e._customChangesOrder).push(t),p(e)}function d(){var n=[];return e.add=function(e){n.push(e)},e;function e(){var e,t,a=n.length;for(e=0;e<a;++e)t=n[e].apply(this,arguments);return t}}function g(n,e,t){var a=n[e];a.add?a.add(t):((a=d()).add(n[e]),a.add(t)),n[e]=a}function _(n){var e=this.prototype;e._plugins.push(n),n.members&&t(this.prototype,n.members),n.customize&&n.customize(this),n.extenders&&Object.keys(n.extenders).forEach((function(t){var a=n.extenders[t];g(e,t,a)}),this)}r.prototype={constructor:r,add:function(n){var e,t=n.length,a=this._flags;for(e=0;e<t;++e)a[n[e]]=1;this._k+=t},has:function(n){return this._flags[n]>0},count:function(){return this._k},reset:function(){this._flags={},this._k=0}},e.replaceInherit=o?function(n){var e=n.inherit;n.inherit=function(){var n=e.apply(this,arguments),t=n.prototype;return["_plugins","_eventsMap","_initialChanges","_themeDependentChanges","_optionChangesMap","_optionChangesOrder","_layoutChangesOrder","_customChangesOrder","_totalChangesOrder"].forEach((function(n){t[n]={}})),n.addPlugin=i,n},n.addChange=i,n.addPlugin=i}:function(n){var e=n.inherit;n.inherit=function(){var n=this.prototype,t=n._plugins,a=n._eventsMap,i=n._initialChanges,o=n._themeDependentChanges,r=n._optionChangesMap,u=n._partialOptionChangesMap,d=n._partialOptionChangesPath,g=n._optionChangesOrder,c=n._layoutChangesOrder,l=n._customChangesOrder,C=e.apply(this,arguments);return(n=C.prototype)._plugins=h(t,n._plugins),n._eventsMap=s(a,n._eventsMap),n._initialChanges=h(i,n._initialChanges),n._themeDependentChanges=h(o,n._themeDependentChanges),n._optionChangesMap=s(r,n._optionChangesMap),n._partialOptionChangesMap=s(u,n._partialOptionChangesMap),n._partialOptionChangesPath=s(d,n._partialOptionChangesPath),n._optionChangesOrder=h(g,n._optionChangesOrder),n._layoutChangesOrder=h(c,n._layoutChangesOrder),n._customChangesOrder=h(l,n._customChangesOrder),p(n),C.addPlugin=_,C},n.prototype._plugins=[],n.addChange=u,n.addPlugin=_},e.changes=function(){return new r},e.expand=g}

