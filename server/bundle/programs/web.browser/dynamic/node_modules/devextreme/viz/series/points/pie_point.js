function module(t,i,e){"use strict";var s=t("../../../core/utils/extend").extend,n=t("./symbol_point"),r=s,a=Math.round,h=Math.sqrt,o=Math.acos,l=180/Math.PI,c=Math.abs,u=t("../../core/utils"),d=u.normalizeAngle,g=u.getCosAndSin,b=t("../../../core/utils/type").isDefined,f=u.getVerticallyShiftedAngularCoords,m=t("../../components/consts").radialLabelIndent;e.exports=r({},n,{_updateData:function(t,i){var e=this;n._updateData.call(this,t),!i&&b(this._visible)||(this._visible=!0),this.minValue=this.initialMinValue=this.originalMinValue=b(t.minValue)?t.minValue:0},animate:function(t,i,e){var s=this;this.graphic.animate({x:this.centerX,y:this.centerY,outerRadius:this.radiusOuter,innerRadius:this.radiusInner,startAngle:this.toAngle,endAngle:this.fromAngle},{delay:e,partitionDuration:i},t)},correctPosition:function(t){var i=this;this.correctRadius(t),this.correctLabelRadius(t.radiusOuter+m),this.centerX=t.centerX,this.centerY=t.centerY},correctRadius:function(t){this.radiusInner=t.radiusInner,this.radiusOuter=t.radiusOuter},correctLabelRadius:function(t){this.radiusLabels=t},correctValue:function(t,i,e){var s=this;this.value=(e||this.normalInitialValue)+t,this.minValue=t,this.percent=i,this._label.setDataField("percent",i)},_updateLabelData:function(){this._label.setData(this._getLabelFormatObject())},_getShiftLabelCoords:function(){var t=this,i=this._label.getBoundingRect(),e=this._getLabelCoords(this._label),s=this._getVisibleArea();return this._isLabelDrawingWithoutPoints?this._checkLabelPosition(e,i,s):this._getLabelExtraCoord(e,this._checkVerticalLabelPosition(e,i,s),i)},_getLabelPosition:function(t){return t.position},_getLabelCoords:function(t){var i,e,s=this,n=t.getBoundingRect(),r=t.getLayoutOptions(),h=g(this.middleAngle),o=this._getLabelPosition(r),l=this.radiusInner,c=this.radiusOuter,u=this.radiusLabels,d="columns"===o;return"inside"===o?(i=l+(c-l)/2+r.radialOffset,e=this.centerX+i*h.cos-n.width/2):(i=u+r.radialOffset,e=h.cos>.1||d&&h.cos>=0?this.centerX+i*h.cos:h.cos<-.1||d&&h.cos<0?this.centerX+i*h.cos-n.width:this.centerX+i*h.cos-n.width/2),{x:e,y:a(this.centerY-i*h.sin-n.height/2)}},_correctLabelCoord:function(t,i){var e=this,s=this._label,n,r=s.getBoundingRect().width,a=s.getLayoutOptions(),h=this._getVisibleArea(),o=h.maxX-r,l=h.minX,c=d(this.middleAngle),u=this.centerX,g=a.connectorOffset,b=t.x;return"columns"===a.position?(b=c<=90||c>=270?o:l,t.x=b):"inside"!==a.position&&i&&(c<=90||c>=270?b-g<u&&(b=u+g):b+r+g>u&&(b=u-r-g),t.x=b),t},drawLabel:function(){this.translate(),this._isLabelDrawingWithoutPoints=!0,this._drawLabel(),this._isLabelDrawingWithoutPoints=!1},updateLabelCoord:function(t){var i=this,e=this._label.getBoundingRect(),s=this._correctLabelCoord(e,t);s=this._checkHorizontalLabelPosition(s,e,this._getVisibleArea()),this._label.shift(a(s.x),a(e.y))},_checkVerticalLabelPosition:function(t,i,e){var s=t.x,n=t.y;return t.y+i.height>e.maxY?n=e.maxY-i.height:t.y<e.minY&&(n=e.minY),{x:s,y:n}},_getLabelExtraCoord:function(t,i,e){return t.y!==i.y?f({x:t.x,y:t.y,width:e.width,height:e.height},i.y-t.y,{x:this.centerX,y:this.centerY}):t},_checkHorizontalLabelPosition:function(t,i,e){var s=t.x,n=t.y;return t.x+i.width>e.maxX?s=e.maxX-i.width:t.x<e.minX&&(s=e.minX),{x:s,y:n}},setLabelEllipsis:function(t){var i=this,e=this._label,s=e.getBoundingRect(),n=this._getVisibleArea(),r=e.getLayoutOptions().position,a=s.width;"columns"===r&&this.series.index>0?a=n.maxX-this.centerX-this.radiusLabels:"inside"===r?a>n.maxX-n.minX&&(a=n.maxX-n.minX):t&&s.x<this.centerX&&s.width+s.x>this.centerX?a=Math.floor((n.maxX-n.minX)/2):s.x+a>n.maxX?a=n.maxX-s.x:s.x<n.minX&&(a=s.x+a-n.minX),a<s.width&&e.fit(a)},setLabelTrackerData:function(){this._label.setTrackerData(this)},_checkLabelPosition:function(t,i,e){return t=this._checkHorizontalLabelPosition(t,i,e),this._checkVerticalLabelPosition(t,i,e)},_getLabelConnector:function(){var t=this,i=this.radiusOuter,e=this._options.styles.normal,s=e["stroke-width"]/2,n=this.series.getOptions().containerBackgroundColor===e.stroke?a(s):a(-s),r=g(a(this.middleAngle));return{x:a(this.centerX+(i-n)*r.cos),y:a(this.centerY-(i-n)*r.sin),angle:this.middleAngle}},_drawMarker:function(t,i,e,s){var n=this,r=this.radiusOuter,a=this.radiusInner,h=this.fromAngle,o=this.toAngle;e&&(a=r=0,s||(h=o=this.shiftedAngle)),this.graphic=t.arc(this.centerX,this.centerY,a,r,o,h).attr({"stroke-linejoin":"round"}).smartAttr(this._getStyle()).data({"chart-data-point":this}).sharp().append(i)},getTooltipParams:function(){var t=this,i=g(this.middleAngle),e=this.radiusInner,s=this.radiusOuter;return{x:this.centerX+(e+(s-e)/2)*i.cos,y:this.centerY-(e+(s-e)/2)*i.sin,offset:0}},_translate:function(){var t=this,i=this.shiftedAngle||0,e=this.value,s=this.minValue,n=this._getValTranslator();this.fromAngle=n.translate(s)+i,this.toAngle=n.translate(e)+i,this.middleAngle=n.translate((e-s)/2+s)+i,this.isVisible()||(this.middleAngle=this.toAngle=this.fromAngle=this.fromAngle||i)},getMarkerVisibility:function(){return!0},_updateMarker:function(t,i,e,s){var n=this;t||(i=r({x:this.centerX,y:this.centerY,outerRadius:this.radiusOuter,innerRadius:this.radiusInner,startAngle:this.toAngle,endAngle:this.fromAngle},i)),this.graphic.smartAttr(i).sharp(),s&&s()},getLegendStyles:function(){return this._styles.legendStyles},isInVisibleArea:function(){return!0},hide:function(){var t=this;this._visible&&(this._visible=!1,this.hideTooltip(),this._options.visibilityChanged())},show:function(){var t=this;this._visible||(this._visible=!0,this._options.visibilityChanged())},setInvisibility:function(){this._label.draw(!1)},isVisible:function(){return this._visible},_getFormatObject:function(t){var i=n._getFormatObject.call(this,t),e=this.percent;return i.percent=e,i.percentText=t.formatValue(e,"percent"),i},getColor:function(){return this._styles.normal.fill},coordsIn:function(t,i){var e,s=this,n=t-this.centerX,r=i-this.centerY,a=h(n*n+r*r),u=this.fromAngle%360,d=this.toAngle%360;return!(a<this.radiusInner||a>this.radiusOuter||0===a)&&((e=o(n/a)*l*(r>0?-1:1))<0&&(e+=360),u===d&&c(this.toAngle-this.fromAngle)>1e-4||(u>=d?e<=u&&e>=d:!(e>=u&&e<=d)))}})}

