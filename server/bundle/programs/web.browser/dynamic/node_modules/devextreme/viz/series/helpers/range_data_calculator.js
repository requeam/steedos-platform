function module(e,t,a){"use strict";var n=e("../../core/utils").unique,u=e("../../../core/utils/type").isDefined,r=e("../../../core/utils/common").noop,i="discrete";function g(e,t,a){e.min=e.min<t?e.min:t,e.max=e.max>a?e.max:a}function l(e,t){return e===i?function(e,t,a){t!==a&&e.categories.push(a),e.categories.push(t)}:t?function(e,a){var n=t.calculateInterval(a,e.prevValue),u=e.interval;e.interval=(u<n?u:n)||u,e.prevValue=a,g(e,a,a)}:g}function s(e,t,a){var n={axisType:e,dataType:t};return e===i?n.categories=[]:(n.min=a,n.max=a),n}function o(e){e.categories&&(e.categories=n(e.categories))}function c(e,t,a,n){if(t&&u(t.value)&&"datetime"!==n.dataType){var r=e.value,i=t.value,g=e.argument,l;return(a-g)*(i-r)/(t.argument-g)+r}return e.value}function v(e){if(e.categories){var t=e.categories.reduce((function(e,t){return e[t.valueOf()]=!0,e}),{});return function(e){return t[e.valueOf()]}}return u(e.startValue)||u(e.endValue)?u(e.endValue)?u(e.startValue)?function(t){return t>=e.startValue&&t<=e.endValue}:function(t){return t<=e.endValue}:function(t){return t>=e.startValue}:function(){return!0}}function m(e,t,a,n,u){var r=c(a,n,u,t);e(t,r,r)}function f(e){return e.type.toLowerCase().indexOf("line")>=0||e.type.toLowerCase().indexOf("area")>=0}function V(e){var t,a=l(e.valueAxisType),n=e.getArgumentAxis()&&e.getArgumentAxis().visualRange()||{},i=f(e)?m:r;return t=v(n),function(e,r,g,l){var s=r.argument;return r.hasValue()?(t(s)?(e.startCalc||(e.startCalc=!0,i(a,e,r,l[g-1],n.startValue)),a(e,r.getMinValue(),r.getMaxValue())):!n.categories&&u(n.startValue)&&s>n.startValue&&(e.startCalc||i(a,e,r,l[g-1],n.startValue),e.endCalc=!0,i(a,e,r,l[g-1],n.endValue)),e):e}}a.exports={getArgumentRange:function(e){var t=e._data||[],a={};if(t.length)if(e.argumentAxisType===i)a={categories:t.map((function(e){return e.argument}))};else{var n=void 0;if(t.length>1){var u=e.getArgumentAxis().calculateInterval(t[0].argument,t[1].argument),r=e.getArgumentAxis().calculateInterval(t[t.length-1].argument,t[t.length-2].argument);n=Math.min(u,r)}a={min:t[0].argument,max:t[t.length-1].argument,interval:n}}return a},getRangeData:function(e){var t=e.getPoints(),a=e.useAggregation(),n=l(e.argumentAxisType,t.length>1&&e.getArgumentAxis()),r=l(e.valueAxisType),g=V(e),c=t.reduce((function(e,t,a,u){var i=t.argument;return n(e.arg,i,i),t.hasValue()&&(r(e.val,t.getMinValue(),t.getMaxValue()),g(e.viewport,t,a,u)),e}),{arg:s(e.argumentAxisType,e.argumentType,t.length?t[0].argument:void 0),val:s(e.valueAxisType,e.valueType,t.length?e.getValueRangeInitialValue():void 0),viewport:s(e.valueAxisType,e.valueType,t.length?e.getValueRangeInitialValue():void 0)});if(a){var v=this.getArgumentRange(e);if(e.argumentAxisType===i)c.arg=v;else{var m=e.getArgumentAxis().getViewport();(u(m.startValue)||u(m.length))&&n(c.arg,v.min,v.min),(u(m.endValue)||u(m.length)&&u(m.startValue))&&n(c.arg,v.max,v.max)}}return o(c.arg),o(c.val),c},getViewport:function(e){var t,a=e.getPoints(),n={};return t=V(e),n=s(e.valueAxisType,e.valueType,a.length?e.getValueRangeInitialValue():void 0),a.some((function(e,u){return t(n,e,u,a),n.endCalc})),n},getPointsInViewPort:function(e){var t=v(e.getArgumentAxis().visualRange()||{}),a=e.getValueAxis().visualRange()||{},n=v(a),u=e.getPoints(),i=function(e,t,u){var r=t.getMinValue(),i=t.getMaxValue(),g=n(r),l=n(i);g&&e.push(r),i!==r&&l&&e.push(i),!u||g||l||(e.length?e.push(a.endValue):e.push(a.startValue))},g=f(e)?function(e,a,n){var u=a[n],r=a[n-1],g=a[n+1];g&&t(g.argument)&&i(e[1],u,!0),r&&t(r.argument)&&i(e[1],u,!0)}:r,l=function(e,a,n){return t(a.argument)?i(e[0],a):g(e,u,n),e};return u.reduce(l,[[],[]])}}}

