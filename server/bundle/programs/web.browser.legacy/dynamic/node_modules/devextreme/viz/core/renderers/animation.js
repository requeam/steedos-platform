function module(t,i){"use strict";var n=t("../../../animation/frame"),e=function(){},o={easeOutCubic:function(t,i,n){return 1===t?n:(1-Math.pow(1-t,3))*(n-i)+ +i},linear:function(t,i,n){return 1===t?n:t*(n-i)+ +i}};i.easingFunctions=o;var s={segments:function t(i,n,e,o,s){var a,r,m,h,u=n.from,c=n.to,t=[];for(m=0;m<u.length;m++){if(r=[(a=u[m])[0]],a.length>1)for(h=1;h<a.length;h++)r.push(o(e,a[h],c[m][h]));t.push(r)}s.segments=n.end&&1===e?n.end:t,i.attr({segments:t})},arc:function(t,i,n,e){var o=i.from,s=i.to,a={};for(var r in o)a[r]=e(n,o[r],s[r]);t.attr(a)},transform:function(t,i,n,e,o){var s=i.from,a=i.to,r={};for(var m in s)r[m]=o[m]=e(n,s[m],a[m]);t.attr(r)},base:function(t,i,n,e,o,s){var a={};a[s]=o[s]=e(n,i.from,i.to),t.attr(a)},_:e,complete:function(t,i){t.attr(i)}};function a(t){var i,n=this,e=this._animateStep;for(i in this._progress=this._calcProgress(t),this.params){var o;(e[i]||e.base)(this.element,this.params[i],this._progress,this._easing,this._currentParams,i)}return this.options.step&&this.options.step(this._easing(this._progress,0,1),this._progress),1!==this._progress||this.stop()}function r(t){return t-this._startTime>=this.delay&&(this.tick=a),!0}function m(t){return this._startTime=t,this.tick=this.delay?r:a,!0}function h(t,i,n){var e=this;this._progress=0,this.element=t,this.params=i,this.options=n,this.duration=n.partitionDuration?n.duration*n.partitionDuration:n.duration,this.delay=n.delay&&n.duration*n.delay||0,this._animateStep=n.animateStep||s,this._easing=o[n.easing]||o.easeOutCubic,this._currentParams={},this.tick=m}function u(t){var i=this;this._animationCount=0,this._timerId=null,this._animations={},this.element=t}h.prototype={_calcProgress:function(t){return Math.min(1,(t-this.delay-this._startTime)/this.duration)},stop:function(t){var i=this,n=this.options,o=this._animateStep;this.stop=this.tick=e,o.complete&&o.complete(this.element,this._currentParams),n.complete&&!t&&n.complete()}},i.AnimationController=u,u.prototype={_loop:function(){var t,i=this,e=i._animations,o=0,s=(new Date).getTime(),a=i._endAnimation;for(t in e)e[t].tick(s)||delete e[t],o++;if(0===o)return i.stop(),void(i._endAnimationTimer=a&&setTimeout((function(){0===i._animationCount&&(a(),i._endAnimation=null)})));i._timerId=n.requestAnimationFrame.call(null,(function(){i._loop()}),i.element)},addAnimation:function(t){var i=this;i._animations[i._animationCount++]=t,clearTimeout(i._endAnimationTimer),i._timerId||(clearTimeout(i._startDelay),i._startDelay=setTimeout((function(){i._timerId=1,i._loop()}),0))},animateElement:function(t,i,n){t&&i&&n&&(t.animation&&t.animation.stop(),this.addAnimation(t.animation=new h(t,i,n)))},onEndAnimation:function(t){this._animationCount?this._endAnimation=t:t()},dispose:function(){this.stop(),this.element=null},stop:function(){var t=this;this._animations={},this._animationCount=0,n.cancelAnimationFrame(this._timerId),clearTimeout(this._startDelay),clearTimeout(this._endAnimationTimer),this._timerId=null},lock:function(){var t,i,n,e=this._animations;for(t in e)i=e[t].options.unstoppable,n=n||i,i||(e[t].stop(!0),delete e[t]);!n&&this.stop()}},i.animationSvgStep=s}

