function module(e,r,t){"use strict";var n=e("./utils").normalizeEnum,i=Math.min,a=Math.max,o=0,u=1,c=2,s={left:o,center:u,right:2},f={top:o,center:u,bottom:2},l={horizontal:0,vertical:1},m={};function p(e,r,t){var i=n(e);return i in r?r[i]:t}function d(e){var r=p(e.side,l,1),t=[p(e.horizontalAlignment,s,u),p(e.verticalAlignment,f,o)];return{side:r,primary:h(t[r]),secondary:t[1-r],weak:e.weak,priority:e.priority||0,header:e.header}}function h(e){return e<2?0:2}function y(e){return 1-e}function v(e,r,t,n){return m[e](r,t,n)}function g(e,r){return(e>0?-1:1)*r}function z(e,r,t){var n=e.side,i=e.element.measure([r[2]-r[0],r[3]-r[1]]),a=i[n]<r[2+n]-r[n]-t[n];return a&&(r[e.primary+n]+=g(e.primary,i[n]),e.size=i),a}function _(e,r,t){var n=e.side,i=y(n),a=[],o=v(e.secondary,t[i],t[2+i],e.size[i]);return a[n]=a[2+n]=r[e.primary+n],a[e.primary+n]=r[e.primary+n]-=g(e.primary,e.size[n]),a[i]=o[0],a[2+i]=o[1],a}function w(e,r,t){var n=r.slice(),i=_(e,r,t);e.element.move(i,n)}function k(){this._targets=[]}function S(e){var r,t,n=e.length,i=[];for(r=0;r<n;++r)(t=e[r].layoutOptions())&&((t=d(t)).element=e[r],i.push(t));return i.sort((function(e,r){return e.side-r.side||e.priority-r.priority})),i=x(i)}function x(e){var r,t=e.filter((function(e){return!0===e.weak}))[0];return t&&(r=e.filter((function(e){return t.primary===e.primary&&e.side===t.side&&e!==t}))[0]),t&&r?[M(r,t)].concat(e.filter((function(e){return!(e===r||e===t)}))):e}function M(e,r){var t=e.side,n=e.primary,i=e.secondary,a=y(t);return{side:t,primary:n,secondary:i,priority:0,element:{measure:function(n){var i=e.element.measure(n.slice()),a=r.element.measure(n.slice()),o=i.slice();return o[t]=Math.max(i[t],a[t]),a[t]+=(o[t]-a[t])/2,i[t]+=(o[t]-a[t])/2,r.size=a,e.size=i,o},move:function(t,n){var i=_(r,n,n),o=t[a+2]-i[a];o>0&&(t[a]-=o,t[a+2]-=o,t[a]<0&&(t[a]=0)),r.element.move(i),e.element.move(t)},freeSpace:function(){e.element.freeSpace(),r.element.freeSpace()}}}}m[o]=function(e,r,t){return[e,i(r,e+t)]},m[u]=function(e,r,t){return[a(e,(e+r-t)/2),i(r,(e+r+t)/2)]},m[2]=function(e,r,t){return[a(e,r-t),r]},k.prototype={constructor:k,dispose:function(){this._targets=null},add:function(e){this._targets.push(e)},forward:function(e,r){var t,n=e.slice(),i=S(this._targets),a=i.length,o=[];for(t=0;t<a;++t)z(i[t],n,r)?o.push(i[t]):i[t].element.freeSpace();return this._cache=o.reverse(),n},backward:function(e,r){var t,n,i=e.slice(),a=this._cache,o=0,u=a.length;for(n=0;n<u;++n)(t=a[n]).side!==o&&(i=e.slice()),w(t,i,r),o=t.side;this._cache=null}},t.exports=k}

