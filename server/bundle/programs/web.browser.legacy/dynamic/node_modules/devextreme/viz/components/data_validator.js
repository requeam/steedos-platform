function module(e,n){"use strict";var t=e("../../core/utils/type"),r="string",u="numeric",i="datetime",o="discrete",a="semidiscrete",s="continuous",c="logarithmic",f="valueType",p="argumentType",l=e("../../core/utils/extend").extend,g=e("../core/utils").enumParser([r,u,i]),v=e("./parse_utils").getParser,y=t.isDefined,h=t.isFunction,T=Array.isArray,m=t.isString,A=t.isDate,d=t.isNumeric,x=t.isObject;function E(e,n,t,r){r>=0&&e.slice(r).forEach((function(e){y(e[t])&&(n[t]+=e[t],e[t]=void 0)}))}function O(e){e.forEach((function(e){e.valueType=e.valueAxisType=null,e.series.forEach((function(e){e.updateDataType({})})),e.valueAxis&&e.valueAxis.resetTypes(f)}))}function F(e,n,t){var r=n?function(e,n){return e-n}:function(e,n){return n-e};return e.sort((function(e,n){var u=t(e),i=t(n),o=y(u)?1:0,a=y(i)?1:0;return o&&a?r(u,i):r(o,a)})),e}function D(e){e&&e.forEach((function(e){e.resetTypes(p)}))}function S(e,n){var t=[];return e.forEach((function(e){var r=n(e);void 0!==r&&t.push(r)})),t}function V(e,n){var t=e.argumentOptions&&e.argumentOptions.categories;e.groups.forEach((function(e,t){var r=e.valueOptions&&e.valueOptions.categories;r&&(e.valueOptions.categories=S(r,n[t+1]))})),t&&(e.argumentOptions.categories=S(t,n[0]))}function N(e,n,t){return e<=0&&null!==e&&(t("E2004",[n]),e=null),e}function k(e){return e}function w(e,n){var t=n;return n===r||m(e)?t=r:n===i||A(e)?t=i:d(e)&&(t=u),t}function z(e,n,t,u){return e!==r||n!==s&&n!==c&&n!==a||u("E2002"),n===c?c:t||n===o||e===r?o:n===a?a:s}function P(e,n,t){e&&t(d(e)||A(e)||m(e)?"E2004":"E2003",[n])}function Z(e,n,t){var r=e?v(e):k,u=n===c?N:k,i=n!==o?function(e){return isFinite(e)||void 0===e?e:null}:k;return function(e,n){var o,a=function(e){return u(e,n,t)}(i(r(e)));return void 0===a&&P(e,n,t),a}}function _(e,n){var t,r,i=Z(e.argumentType,e.argumentAxisType,n),o=[i],a={},c=[];for(var f in e.groups.forEach((function(e,c){e.series.forEach((function(f){r=Z(e.valueType,e.valueAxisType,n),t=Z(u,s,n),a[f.getArgumentField()]=i,f.getValueFields().forEach((function(e){o[c+1]=r,a[e]=r})),f.getSizeField()&&(a[f.getSizeField()]=t)}))})),a)c.push([f,a[f]]);return c.length&&V(e,o),c}function b(e,n){var t,r,u,i=n.length,o=l({},e);for(t=0;t<i;++t)u=e[r=n[t][0]],o[r]=n[t][1](u,r);return o}function j(e,n){var t,r=[],u=e.length;for(r.length=u,t=0;t<u;++t)r[t]=b(e[t],n);return r}function C(e,n,t){var r,u,i=e.length;for(r=0;r<i&&(u=e[r][n],!(y(u)&&t>u));++r);return r}function G(e,n,t,r){var u,i=(r=r||{}).mode,o={};i&&"none"!==i&&(o[n]=String(r.groupName||"others"),o[t]=0,E(u=F(e.slice(),!1,(function(e){return e[t]})),o,t,"smallValueThreshold"===i?C(u,t,r.threshold):r.topCount),o[t]&&e.push(o))}function M(e,n){var t=n.groups[0]&&n.groups[0].series[0],r;t&&("pie"===t.type||"doughnut"===t.type||"donut"===t.type)&&n.groups.forEach((function(n){n.series.forEach((function(n){G(e,n.getArgumentField(),n.getValueFields()[0],n.getOptions().smallValuesGrouping)}))}))}function q(e,n,t){t[e]||(n.push(e),t[e]=!0)}function B(e){var n=[],t={};return e.groups.forEach((function(e){e.series.forEach((function(e){q(e.getArgumentField(),n,t)}))})),n}function H(e,n){var t=e-n;return isNaN(t)?y(e)?y(n)?0:-1:1:t}function I(e,n){return e.slice().sort((function(e,t){return H(e[n],t[n])}))}function J(e,n){return e.slice().sort(n)}function K(e,n){return e.series.forEach((function(t){t.getValueFields().forEach((function(t){e.valueType=w(n[t],e.valueType)}))})),e.valueType}function L(e){var n={};return e.forEach((function(e,t){n[e]=t})),function(e,t){return F(e.slice(),!0,(function(e){return n[e[t]]}))}}function Q(e,n,t,u){var i,a={},s=n.argumentAxisType===o,c=s&&n.argumentOptions&&n.argumentOptions.categories,f=function(e){return e},p=t.sortingMethod;return!c&&h(p)&&(e=J(e,p)),s&&(n.categories=U(e,u,c)),c||!h(p)&&n.argumentType===r&&!t._skipArgumentSorting?f=L(n.categories):!0===p&&n.argumentType!==r&&(f=I,i=s),u.forEach((function(n){a[n]=f(e,n)})),i&&(n.categories=n.categories.sort(H)),a}function R(e,n){return-1===e.map((function(e){return e.valueOf()})).indexOf(n.valueOf())}function U(e,n,t){var r=t?t.slice():[];return n.forEach((function(n){e.forEach((function(e){var t=e[n];y(t)&&R(r,t)&&r.push(t)}))})),r}function W(e,n,t){return e.forEach((function(e){t.argumentType=w(n[e.getArgumentField()],t.argumentType)})),t.argumentType}function X(e,n,t){var r,u=[],i=[],o=n.argumentOptions&&g(n.argumentOptions.argumentType);n.groups.forEach((function(e){if(e.series.length){var t=e.valueOptions&&g(e.valueOptions.valueType);e.valueType=t,n.argumentType=o,!t&&u.push(e),!o&&i.push(e)}})),(u.length||i.length)&&(r=u.map((function(e,n){return n})),e.some((function(e){var o;if(u.forEach((function(n,t){K(n,e)&&r.indexOf(t)>=0&&r.splice(t,1)})),o||i.forEach((function(t){o=W(t.series,e,n)})),!t&&o&&0===r.length)return!0})))}function Y(e,n){var t=e.argumentOptions||{},r=t&&t.categories||[],u=z(e.argumentType,t.type,!!r.length,n);e.groups.forEach((function(t){var r=t.valueOptions||{},i=r.categories||[],o=z(t.valueType,r.type,!!i.length,n);t.series.forEach((function(n){var i={};i.argumentAxisType=u,i.valueAxisType=o,e.argumentAxisType=e.argumentAxisType||i.argumentAxisType,t.valueAxisType=t.valueAxisType||i.valueAxisType,i.argumentType=e.argumentType,i.valueType=t.valueType,i.showZero=r.showZero,n.updateDataType(i)})),t.valueAxisType=t.valueAxisType||o,t.valueAxis&&(t.valueAxis.setTypes(t.valueAxisType,t.valueType,f),t.valueAxis.validate())})),e.argumentAxisType=e.argumentAxisType||u,e.argumentAxes&&e.argumentAxes.forEach((function(n){n.setTypes(e.argumentAxisType,e.argumentType,p),n.validate()}))}function $(e,n){var t,r,u,i,o=[],a=y(e),s=a&&!T(e);if(a&&!s)for(t=0,r=e.length,u=0;t<r;++t)i=e[t],x(i)?o[u++]=i:i&&(s=!0);return s&&n("E2001"),o}function ee(e,n,t,r){var u;return e=$(e,t),n.argumentType=n.argumentAxisType=null,O(n.groups),D(n.argumentAxes),X(e,n,r.checkTypeForAllData),Y(n,t),r.convertToAxisDataType&&(e=j(e,_(n,t))),M(e,n),u=Q(e,n,r,B(n))}n.validateData=ee}

