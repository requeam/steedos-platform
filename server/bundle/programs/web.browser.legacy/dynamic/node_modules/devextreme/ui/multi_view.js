function module(e,t,i){"use strict";var n,s=S(e("../core/renderer")),o,a=S(e("../animation/fx")),r,d=S(e("../animation/translator")),l,u=S(e("../core/utils/math")),c=e("../core/utils/extend"),h=e("../core/utils/common"),m=e("../core/utils/dom"),p=e("../core/utils/type"),_,f=S(e("../core/devices")),v,I=S(e("../core/component_registrator")),w,g=S(e("./collection/ui.collection_widget.live_update")),C,b=S(e("../events/gesture/swipeable")),x=e("../core/utils/deferred");function S(e){return e&&e.__esModule?e:{default:e}}var D="dx-multiview",E="dx-multiview-wrapper",y="dx-multiview-item-container",B="dx-multiview-item",$="dx-multiview-item-hidden",V="dxMultiViewItemData",F=200,R=function(e){return+e},L=function(e){return d.default.locate(e).left},W=function(e,t){d.default.move(e,{left:t})},k=function(e,t,i,n){a.default.animate(e,{type:"slide",to:{left:t},duration:i,complete:n})},O=function(e){a.default.stop(e,!0)},T=g.default.inherit({_activeStateUnit:".dx-multiview-item",_supportedKeys:function(){return(0,c.extend)(this.callBase(),{pageUp:h.noop,pageDown:h.noop})},_getDefaultOptions:function(){return(0,c.extend)(this.callBase(),{selectedIndex:0,swipeEnabled:!0,animationEnabled:!0,loop:!1,deferRendering:!0,_itemAttributes:{role:"tabpanel"},loopItemFocus:!1,selectOnFocus:!0,selectionMode:"single",selectionRequired:!0,selectionByClick:!1})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return"desktop"===f.default.real().deviceType&&!f.default.isSimulator()},options:{focusStateEnabled:!0}}])},_itemClass:function(){return"dx-multiview-item"},_itemDataKey:function(){return"dxMultiViewItemData"},_itemContainer:function(){return this._$itemContainer},_itemElements:function(){return this._itemContainer().children(this._itemSelector())},_itemWidth:function(){return this._itemWidthValue||(this._itemWidthValue=this._$wrapper.width()),this._itemWidthValue},_clearItemWidthCache:function(){delete this._itemWidthValue},_itemsCount:function(){return this.option("items").length},_normalizeIndex:function(e){var t=this._itemsCount();return e<0&&(e+=t),e>=t&&(e-=t),e},_getRTLSignCorrection:function(){return this.option("rtlEnabled")?-1:1},_init:function(){this.callBase.apply(this,arguments);var e=this.$element();e.addClass("dx-multiview"),this._$wrapper=(0,s.default)("<div>").addClass("dx-multiview-wrapper"),this._$wrapper.appendTo(e),this._$itemContainer=(0,s.default)("<div>").addClass("dx-multiview-item-container"),this._$itemContainer.appendTo(this._$wrapper),this.option("loopItemFocus",this.option("loop")),this._initSwipeable()},_initMarkup:function(){this._deferredItems=[],this.callBase()},_afterItemElementDeleted:function(e,t){this.callBase(e,t),this._deferredItems&&this._deferredItems.splice(t.itemIndex,1)},_beforeItemElementInserted:function(e){this.callBase.apply(this,arguments),this._deferredItems&&this._deferredItems.splice(e.index,0,null)},_executeItemRenderAction:function(e,t,i){e=(this.option("items")||[]).indexOf(t),this.callBase(e,t,i)},_renderItemContent:function(e){var t=new x.Deferred,i=this,n=this.callBase,s=new x.Deferred;return s.done((function(){var s=n.call(i,e);t.resolve(s)})),this._deferredItems[e.index]=s,this.option("deferRendering")||s.resolve(),t.promise()},_render:function(){this.callBase();var e=this._getSelectedItemIndices();this._updateItemsPosition(e[0]),this._updateItemsVisibility(e[0])},_renderSelection:function(e){this._updateItemsVisibility(e[0])},_updateItems:function(e,t){this._updateItemsPosition(e,t),this._updateItemsVisibility(e,t)},_modifyByChanges:function(){this.callBase.apply(this,arguments);var e=this._getSelectedItemIndices();this._updateItemsVisibility(e[0])},_updateItemsPosition:function(e,t){var i=this._itemElements(),n=(0,p.isDefined)(t)?-this._animationDirection(t,e):void 0,s=i.eq(e);W(s,0),(0,p.isDefined)(t)&&W(i.eq(t),100*n+"%")},_updateItemsVisibility:function(e,t){var i;this._itemElements().each(function(i,n){var o=(0,s.default)(n),a=i!==e&&i!==t;a||this._renderSpecificItem(i),o.toggleClass("dx-multiview-item-hidden",a),this.setAria("hidden",a||void 0,o)}.bind(this))},_renderSpecificItem:function(e){var t=this._itemElements().eq(e),i=t.find(this._itemContentClass()).length>0;(0,p.isDefined)(e)&&!i&&(this._deferredItems[e].resolve(),(0,m.triggerResizeEvent)(t))},_refreshItem:function(e,t){this.callBase(e,t),this._updateItemsVisibility(this.option("selectedIndex"))},_setAriaSelected:h.noop,_updateSelection:function(e,t){var i=e[0],n=t[0];O(this._$itemContainer),this._updateItems(n,i);var s=this._animationDirection(i,n);this._animateItemContainer(s*this._itemWidth(),function(){W(this._$itemContainer,0),this._updateItems(i),this._$itemContainer.width()}.bind(this))},_animateItemContainer:function(e,t){var i=this.option("animationEnabled")?200:0;k(this._$itemContainer,e,i,t)},_animationDirection:function(e,t){var i=L(this._$itemContainer),n=(t-e)*this._getRTLSignCorrection()*this._getItemFocusLoopSignCorrection(),s,o=0!==i?i:n;return u.default.sign(o)},_getSwipeDisabledState:function(){return!this.option("swipeEnabled")||this._itemsCount()<=1},_initSwipeable:function(){var e=this;this._createComponent(this.$element(),b.default,{disabled:this._getSwipeDisabledState(),elastic:!1,itemSizeFunc:this._itemWidth.bind(this),onStart:function(t){return e._swipeStartHandler(t.event)},onUpdated:function(t){return e._swipeUpdateHandler(t.event)},onEnd:function(t){return e._swipeEndHandler(t.event)}})},_swipeStartHandler:function(e){O(this._$itemContainer);var t=this.option("selectedIndex"),i=this.option("loop"),n=this._itemsCount()-1,s=this.option("rtlEnabled");e.maxLeftOffset=R(i||(s?t>0:t<n)),e.maxRightOffset=R(i||(s?t<n:t>0)),this._swipeDirection=null},_swipeUpdateHandler:function(e){var t=e.offset,i=u.default.sign(t)*this._getRTLSignCorrection();if(W(this._$itemContainer,t*this._itemWidth()),i!==this._swipeDirection){this._swipeDirection=i;var n=this.option("selectedIndex"),s=this._normalizeIndex(n-i);this._updateItems(n,s)}},_swipeEndHandler:function(e){var t=e.targetOffset*this._getRTLSignCorrection();if(t){this.option("selectedIndex",this._normalizeIndex(this.option("selectedIndex")-t));var i=this.itemElements().filter(".dx-item-selected");this.option("focusStateEnabled")&&this.option("focusedElement",(0,m.getPublicElement)(i))}else this._animateItemContainer(0,h.noop)},_getItemFocusLoopSignCorrection:function(){return this._itemFocusLooped?-1:1},_moveFocus:function(){this.callBase.apply(this,arguments),this._itemFocusLooped=!1},_prevItem:function(e){var t=this.callBase.apply(this,arguments);return this._itemFocusLooped=t.is(e.last()),t},_nextItem:function(e){var t=this.callBase.apply(this,arguments);return this._itemFocusLooped=t.is(e.first()),t},_dimensionChanged:function(){this._clearItemWidthCache()},_visibilityChanged:function(e){e&&this._dimensionChanged()},_updateSwipeDisabledState:function(){var e=this._getSwipeDisabledState();b.default.getInstance(this.$element()).option("disabled",e)},_optionChanged:function(e){var t=e.value;switch(e.name){case"loop":this.option("loopItemFocus",t);break;case"animationEnabled":break;case"swipeEnabled":this._updateSwipeDisabledState();break;case"deferRendering":this._invalidate();break;case"items":this._updateSwipeDisabledState(),this.callBase(e);break;default:this.callBase(e)}}});(0,I.default)("dxMultiView",T),i.exports=T,i.exports.default=i.exports}

