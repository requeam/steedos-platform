function module(e,t,i){"use strict";var n,l=b(e("../../core/renderer")),s,o=b(e("../../events/core/events_engine")),a,r=b(e("../../events/core/wheel")),d,c=b(e("../../localization/message")),u,h=b(e("../grid_core/ui.grid_core.utils")),m=e("../../core/utils/type"),f=e("../../core/utils/extend"),g=e("../../core/utils/iterator"),x,_=b(e("../../core/utils/browser")),p,C=b(e("../../animation/translator"));function b(e){return e&&e.__esModule?e:{default:e}}var T="content",v="content-fixed",E="dx-master-detail-cell",F="dx-first-cell",B="dx-last-cell",w="dx-state-hover",R="dx-col-fixed",y="dx-fixed-columns",P="dx-pointer-events-target",S="dx-pointer-events-none",I="transparent",H="dx-group-row",V=function(e){var t=-1;return(0,g.each)(e,(function(e,i){if("transparent"===i.command)return t=e,!1})),t},W=function(e,t,i){var n,l=0;if(e&&t&&i)for(n=0;n<e.length;n++)"transparent"===e[n].command?l+=e[n].colspan:(t[l]<i[n]&&(t[l]=i[n]),l++);return t},O={init:function(){this.callBase(),this._isFixedTableRendering=!1,this._isFixedColumns=!1},_createCol:function(e){return this.callBase(e).toggleClass("dx-col-fixed",!(!this._isFixedTableRendering||!(e.fixed||e.command&&"transparent"!==e.command)))},_correctColumnIndicesForFixedColumns:function(e,t){var i=V(e),n=e[i].colspan,l=t&&t.columnIndices;l&&(t.columnIndices=l.map((function(e){if(e)return e.map((function(e){return e<i?e:e>=i+n?e-n+1:-1})).filter((function(e){return e>=0}))})))},_renderTable:function(e){var t,i,n=this,l=this.getFixedColumns();if(this._isFixedColumns=!!l.length,i=this.callBase(e),this._isFixedColumns){this._isFixedTableRendering=!0;var s=e&&e.change,o=s&&s.columnIndices;this._correctColumnIndicesForFixedColumns(l,s),t=this._createTable(l),this._renderRows(t,(0,f.extend)({},e,{columns:l})),this._updateContent(t,s),o&&(s.columnIndices=o),this._isFixedTableRendering=!1}else this._fixedTableElement&&this._fixedTableElement.remove(),this._fixedTableElement=null;return i},_renderRow:function(e,t){var i,n,l=t.row.cells;if(this.callBase.apply(this,arguments),this._isFixedTableRendering&&l&&l.length){n=0,i=t.row.cells||[],l=l.slice(),t.row.cells=l;for(var s=0;s<i.length;s++)i[s].column&&"transparent"===i[s].column.command?n=(i[s].column.colspan||1)-1:l[s+n]=i[s]}},_createCell:function(e){var t,i,n,l=this,s=e.column,o=s&&s.command,a=e.rowType,r=l.callBase.apply(l,arguments);return(l._isFixedTableRendering||"filter"===a)&&(i=(t=l.getFixedColumns())[(n=V(t))-1]),l._isFixedTableRendering?"transparent"===o&&(r.addClass("dx-pointer-events-none").toggleClass("dx-first-cell",0===n||i&&"expand"===i.command).toggleClass("dx-last-cell",t.length&&n===t.length-1),"freeSpace"!==a&&h.default.setEmptyText(r)):"filter"===a&&r.toggleClass("dx-first-cell",e.columnIndex===n),r},_wrapTableInScrollContainer:function(){var e=this.callBase.apply(this,arguments);return this._isFixedTableRendering&&e.addClass(this.addWidgetPrefix("content-fixed")+" dx-pointer-events-target"),e},_renderCellContent:function(e,t){var i,n,l,s,o=this,a=t.column,r=this._isFixedTableRendering,d="group"===t.rowType&&(0,m.isDefined)(a.groupIndex);if(r&&d&&!a.command&&e.css("pointerEvents","none"),!r&&this._isFixedColumns&&(n=a.fixed||a.command&&!1!==a.fixed,d&&(n=!1,t.row.summaryCells&&t.row.summaryCells.length&&(i=this._columnsController.getVisibleColumns(),(s=this._getAlignByColumnCellCount?this._getAlignByColumnCellCount(a.colspan,{columns:i,row:t.row,isFixed:!0}):0)>0&&(l=V(this._columnsController.getFixedColumns()),n=i.length-s<l))),n)){if(this.option("legacyRendering")||a.command&&"buttons"!==a.type||"group"===t.rowType)return void e.html("&nbsp;").addClass(a.cssClass);e.addClass("dx-hidden-cell")}"transparent"!==a.command&&this.callBase(e,t)},_getCellElementsCore:function(e){var t,i,n,l,s=this,o=s.callBase(e),a=o.parent().hasClass("dx-group-row"),r="columnHeadersView"===s.name?e:void 0;return s._fixedTableElement&&o&&(i=s.getFixedColumns(r),l=s._getRowElements(s._fixedTableElement).eq(e).children("td"),(0,g.each)(l,(function(e,d){a?o[e]&&"hidden"!==d.style.visibility&&(o[e]=d):(t=i[e])&&("transparent"===t.command?l.eq(e).hasClass("dx-master-detail-cell")&&(o[e]=d||o[e]):(n=s._columnsController.getVisibleIndex(t.index,r),o[n]=d||o[n]))}))),o},getColumnWidths:function(){var e,t=this,i=this.callBase(),n=this.getFixedColumns();return this._fixedTableElement&&i.length&&(e=this.callBase(this._fixedTableElement)),W(n,i,e)},_getTableElement:function(){var e;return this._isFixedTableRendering?this._fixedTableElement:this.callBase()},_setTableElement:function(e){this._isFixedTableRendering?this._fixedTableElement=e.addClass("dx-pointer-events-none"):this.callBase(e)},getColumns:function(e,t){return t=t||this._getTableElement(),this._isFixedTableRendering||t&&t.closest("table").parent("."+this.addWidgetPrefix("content-fixed")).length?this.getFixedColumns(e):this.callBase(e,t)},getRowIndex:function(e){var t=this._fixedTableElement;return t&&t.find(e).length?this._getRowElements(t).index(e):this.callBase(e)},getTableElements:function(){var e=this.callBase.apply(this,arguments);return this._fixedTableElement&&(e=e.add(this._fixedTableElement)),e},getFixedColumns:function(e){return this._columnsController.getFixedColumns(e)},getFixedColumnsOffset:function(){var e,t,i={left:0,right:0};return this._fixedTableElement&&(i={left:(t=(e=this.getTransparentColumnElement()).position()).left,right:this.element().outerWidth(!0)-(e.outerWidth(!0)+t.left)}),i},getTransparentColumnElement:function(){return this._fixedTableElement&&this._fixedTableElement.find(".dx-pointer-events-none").first()},getFixedTableElement:function(){return this._fixedTableElement},isFixedColumns:function(){return this._isFixedColumns},_resizeCore:function(){this.callBase(),this.synchronizeRows()},setColumnWidths:function(e){var t,i=this._columnsController.getVisibleColumns(),n=e&&e.length&&(0,m.isDefined)(i[0].visibleWidth),l=!1;if(this.callBase.apply(this,arguments),this._fixedTableElement){if(this.option("legacyRendering"))l=e&&e.length&&!this.isScrollbarVisible(!0);else{var s=e&&e.some((function(e){return"auto"===e}));l=s&&(!n||!this.isScrollbarVisible(!0))}l&&(t=i),this.callBase(e,this._fixedTableElement,t,!0)}n&&this.synchronizeRows()},_createColGroup:function(e){if(!this.option("legacyRendering")&&this._isFixedTableRendering&&!this.option("columnAutoWidth")){var t=this._columnsController.getVisibleColumns(),i;t.filter((function(e){return!e.width})).length&&(e=t)}return this.callBase(e)},_getClientHeight:function(e){var t=e.getBoundingClientRect&&e.getBoundingClientRect();return t&&t.height?t.height:e.clientHeight},synchronizeRows:function(){var e,t,i,n,l,s,o,a,r=this,d=[],c=[];if(this._isFixedColumns&&this._tableElement&&this._fixedTableElement&&(n=this._getClientHeight(this._tableElement.get(0)),l=this._getClientHeight(this._fixedTableElement.get(0)),s=this._getRowElements(this._tableElement),o=this._getRowElements(this._fixedTableElement),a=this._findContentElement(),n!==l)){for(a&&a.css("height",n),s.css("height",""),o.css("height",""),i=0;i<s.length;i++)d.push(this._getClientHeight(s.get(i))),c.push(this._getClientHeight(o.get(i)));for(i=0;i<s.length;i++)(e=d[i])>(t=c[i])?o.eq(i).css("height",e):e<t&&s.eq(i).css("height",t);a&&a.css("height","")}}},z=(0,f.extend)({},O,{_getRowVisibleColumns:function(e){return this._isFixedTableRendering?this.getFixedColumns(e):this.callBase(e)},getContextMenuItems:function(e){var t,i=this,n=e.column,l=i.option("columnFixing"),s=i.callBase(e);return e.row&&"header"===e.row.rowType&&n&&n.allowFixing&&(t=function(e){switch(e.itemData.value){case"none":i._columnsController.columnOption(n.index,"fixed",!1);break;case"left":i._columnsController.columnOption(n.index,{fixed:!0,fixedPosition:"left"});break;case"right":i._columnsController.columnOption(n.index,{fixed:!0,fixedPosition:"right"})}},(s=s||[]).push({text:l.texts.fix,beginGroup:!0,items:[{text:l.texts.leftPosition,value:"left",disabled:n.fixed&&(!n.fixedPosition||"left"===n.fixedPosition),onItemClick:t},{text:l.texts.rightPosition,value:"right",disabled:n.fixed&&"right"===n.fixedPosition,onItemClick:t}]},{text:l.texts.unfix,value:"none",disabled:!n.fixed,onItemClick:t})),s},setScrollerSpacing:function(e){var t=this,i=this.option("rtlEnabled");this.callBase(e),this.element().children("."+this.addWidgetPrefix("content-fixed")).css(i?{paddingLeft:e}:{paddingRight:e})},getFixedColumnElements:function(e){var t,i,n,l=this;return(0,m.isDefined)(e)?this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(e).children():(t=this.getColumnElements(),n=this.getTransparentColumnElement(),t&&n&&n.length&&(i=V(this.getFixedColumns()),t.splice(i,n.get(0).colSpan,n.get(0))),t)},getColumnWidths:function(){var e,t=this,i=this.callBase(),n=this.getFixedColumnElements(),l=this.getFixedColumns();return this._fixedTableElement&&(e=n&&n.length?this._getWidths(n):this.callBase(this._fixedTableElement)),W(l,i,e)}}),G=(0,f.extend)({},O,{_detachHoverEvents:function(){this._fixedTableElement&&o.default.off(this._fixedTableElement,"mouseover mouseout",".dx-data-row"),this._tableElement&&o.default.off(this._tableElement,"mouseover mouseout",".dx-data-row")},_attachHoverEvents:function(){var e=this,t=function(t){o.default.on(t,"mouseover mouseout",".dx-data-row",e.createAction((function(t){var i=t.event,n=e.getRowIndex((0,l.default)(i.target).closest(".dx-row")),s="mouseover"===i.type;n>=0&&(e._tableElement&&e._getRowElements(e._tableElement).eq(n).toggleClass("dx-state-hover",s),e._fixedTableElement&&e._getRowElements(e._fixedTableElement).eq(n).toggleClass("dx-state-hover",s))})))};e._fixedTableElement&&e._tableElement&&(t(e._fixedTableElement),t(e._tableElement))},_findContentElement:function(){var e,t,i,n=this,s=n.addWidgetPrefix("content"),a=n.element(),d=_.default.mozilla?60:0;return a&&n._isFixedTableRendering?(e=a.children("."+s),t=n.getScrollable(),!e.length&&t&&(e=(0,l.default)("<div>").addClass(s),o.default.on(e,"scroll",(function(e){clearTimeout(n._fixedScrollTimeout),n._fixedScrollTimeout=setTimeout((function(){i=(0,l.default)(e.target).scrollTop(),t.scrollTo({y:i})}),d)})),o.default.on(e,r.default.name,(function(e){if(t&&(i=t.scrollTop(),t.scrollTo({y:i-e.delta}),t.scrollTop()>0&&t.scrollTop()+t.clientHeight()<t.scrollHeight()+n.getScrollbarWidth()))return!1})),e.appendTo(a)),e):n.callBase()},_updateScrollable:function(){this.callBase();var e=this.getScrollable(),t=e&&e.scrollOffset().top;this._updateFixedTablePosition(t)},_renderContent:function(e,t){return this._isFixedTableRendering?e.empty().addClass(this.addWidgetPrefix("content")+" "+this.addWidgetPrefix("content-fixed")+" dx-pointer-events-target").append(t):this.callBase(e,t)},_getGroupCellOptions:function(e){return this._isFixedTableRendering?this.callBase((0,f.extend)({},e,{columns:this._columnsController.getVisibleColumns()})):this.callBase(e)},_renderGroupedCells:function(e,t){return this.callBase(e,(0,f.extend)({},t,{columns:this._columnsController.getVisibleColumns()}))},_renderGroupSummaryCells:function(e,t){this._isFixedTableRendering?this.callBase(e,(0,f.extend)({},t,{columns:this._columnsController.getVisibleColumns()})):this.callBase(e,t)},_hasAlignByColumnSummaryItems:function(e,t){var i=this.callBase.apply(this,arguments),n=t.columns[e];return t.isFixed?n.fixed&&(i||"right"===n.fixedPosition):i&&!n.fixed},_renderGroupSummaryCellsCore:function(e,t,i,n){var l,s,o;this._isFixedTableRendering&&(t.isFixed=!0,o=this._getAlignByColumnCellCount(i,t),t.isFixed=!1,l=t.columns.length-o,t=(0,f.extend)({},t,{columns:this.getFixedColumns()}),l<(s=V(t.columns))?(o-=t.columns[s].colspan-1||0,i-=t.columns[s].colspan-1||0):n>0&&e.css("visibility","hidden"),n=o),this.callBase(e,t,i,n)},_getSummaryCellIndex:function(e,t){var i;return this._isFixedTableRendering?(e>(i=V(t))&&(e+=t[i].colspan-1),e):this.callBase.apply(this,arguments)},_renderCore:function(e){this._detachHoverEvents(),this.callBase(e);var t=this._isFixedColumns;this.element().toggleClass("dx-fixed-columns",t),this.option("hoverStateEnabled")&&t&&this._attachHoverEvents()},setRowsOpacity:function(e,t){this.callBase(e,t);var i=this._getRowElements(this._fixedTableElement);this._setRowsOpacityCore(i,this.getFixedColumns(),e,t)},optionChanged:function(e){var t=this;this.callBase(e),"hoverStateEnabled"===e.name&&this._isFixedColumns&&(e.value?this._attachHoverEvents():this._detachHoverEvents())},getCellIndex:function(e){var t,i=this._fixedTableElement,n=0;return i&&i.find(e).length?(t=this.getFixedColumns(),(0,g.each)(t,(function(t,i){if(t===e[0].cellIndex)return!1;i.colspan?n+=i.colspan:n++})),n):this.callBase.apply(this,arguments)},_updateFixedTablePosition:function(e,t){if(this._fixedTableElement&&this._tableElement){var i,n=this.getController("editorFactory");this._fixedTableElement.parent().scrollTop(e),t&&(i=n.focus())&&n.focus(i)}},setScrollerSpacing:function(e,t){var i,n=this,l={marginBottom:0},s=this.element().children("."+this.addWidgetPrefix("content-fixed"));s.length&&this._fixedTableElement&&(s.css(l),this._fixedTableElement.css(l),l[this.option("rtlEnabled")?"marginLeft":"marginRight"]=e,l.marginBottom=t,((i=this._scrollable&&this._scrollable.option("useNative"))?s:this._fixedTableElement).css(l))},_getElasticScrollTop:function(e){var t=void 0,i=void 0,n=void 0,l=0,s=this.getScrollbarWidth(!0);return e.scrollOffset.top<0?l=-e.scrollOffset.top:e.reachedBottom&&(i=this._findContentElement(),n=e.component._container(),l=(t=Math.max(i.height()+s-n.height(),0))-e.scrollOffset.top),l},_applyElasticScrolling:function(e){if(this._fixedTableElement){var t=this._getElasticScrollTop(e);0!==Math.ceil(t)?C.default.move(this._fixedTableElement,{top:t}):this._fixedTableElement.css("transform","")}},_handleScroll:function(e){this._updateFixedTablePosition(e.scrollOffset.top,!0),this._applyElasticScrolling(e),this.callBase(e)},_updateContentPosition:function(e){this.callBase.apply(this,arguments),e||this._updateFixedTablePosition(this._scrollTop)},_afterRowPrepared:function(e){this._isFixedTableRendering||this.callBase(e)},dispose:function(){this.callBase.apply(this,arguments),clearTimeout(this._fixedScrollTimeout)}}),D=O,q;i.exports={defaultOptions:function(){return{columnFixing:{enabled:!1,texts:{fix:c.default.format("dxDataGrid-columnFixingFix"),unfix:c.default.format("dxDataGrid-columnFixingUnfix"),leftPosition:c.default.format("dxDataGrid-columnFixingLeftPosition"),rightPosition:c.default.format("dxDataGrid-columnFixingRightPosition")}}}},extenders:{views:{columnHeadersView:z,rowsView:G,footerView:D},controllers:(q=function(e,t,i){var n=V(t),l=e.length-t.length;return(0,g.each)(i,(function(e,t){t.index>n&&(t.columnIndex+=l,t.index+=l)})),i},{draggingHeader:{_generatePointsByColumns:function(e){var t,i=e.columns,n=e.targetDraggingPanel;return n&&"headers"===n.getName()&&n.isFixedColumns()&&e.sourceColumn.fixed?(e.rowIndex||(e.columnElements=n.getFixedColumnElements(0)),e.columns=n.getFixedColumns(e.rowIndex),t=this.callBase(e),q(i,e.columns,t),t):this.callBase(e)},_pointCreated:function(e,t,i,n){var l,s=this.callBase.apply(this,arguments),o=this._columnHeadersView.getTransparentColumnElement();return!s&&"headers"===i&&o&&o.length?(l=o.get(0).getBoundingClientRect(),n&&n.fixed?"right"===n.fixedPosition?e.x<l.right:e.x>l.left:e.x<l.left||e.x>l.right):s}},columnsResizer:{_generatePointsByColumns:function(){var e=this,t=e._columnsController,i=t&&e._columnsController.getVisibleColumns(),n=t&&e._columnsController.getFixedColumns(),l=e._columnHeadersView.getFixedColumnElements(),s=[];e.callBase(),l&&l.length>0&&(s=h.default.getPointsByColumns(l,(function(t){return e._pointCreated(t,l.length,n)})),e._pointsByFixedColumns=q(i,n,s))},_pointCreated:function(e,t,i){var n,l,s="widget"===this.option("columnResizingMode");return e.index>0&&e.index<t&&(n=i[e.columnIndex-1]||{},l=i[e.columnIndex]||{},n.fixed||l.fixed)?(e.columnIndex-=1,!((n.allowResizing||"transparent"===n.command)&&(s||l.allowResizing||"transparent"===l.command))):this.callBase.apply(this,arguments)},_getTargetPoint:function(e,t,i){var n,l=this._columnHeadersView.getTransparentColumnElement();return l&&l.length&&(t<=(n=l.get(0).getBoundingClientRect()).left||t>=n.right)?this.callBase(this._pointsByFixedColumns,t,i):this.callBase(e,t,i)}},keyboardNavigation:{_scrollToElement:function(e){var t=this.getFocusedView();this.callBase(e,t&&t.getFixedColumnsOffset())}}})}}}

