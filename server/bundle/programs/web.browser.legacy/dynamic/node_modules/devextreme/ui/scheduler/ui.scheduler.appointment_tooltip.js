function module(t,e,n){"use strict";var i=t("../../core/renderer"),o=t("../tooltip"),a=t("../tooltip/ui.tooltip"),p=t("../button"),s=t("../widget/function_template"),l=t("../../core/utils/date"),r="dx-scheduler-appointment-tooltip-wrapper",d="dx-scheduler-appointment-tooltip",c="dx-scheduler-appointment-tooltip-title",h="dx-scheduler-appointment-tooltip-date",u="dx-scheduler-appointment-tooltip-buttons",m="dx-scheduler-appointment-tooltip-open-button",f="dx-scheduler-appointment-tooltip-close-button",_="dx-scheduler-appointment-tooltip-delete-button",T={show:function(t,e,n,a){if(!this._tooltip||!this._tooltip.option("visible")||i(this._tooltip.option("target")).get(0)!==i(n).get(0)){this.instance=a,this._initDynamicTemplate(t,e,n);var p=a._getAppointmentTemplate("appointmentTooltipTemplate");this.hide(),this._$tooltip=i("<div>").appendTo(a.$element()).addClass(r);var l=a.fire("getTargetedAppointmentData",t,n);this._tooltip=a._createComponent(this._$tooltip,o,{visible:!0,target:n,rtlEnabled:a.option("rtlEnabled"),contentTemplate:new s((function(e){return p.render({model:t,targetedAppointmentData:l,container:e.container})})),position:{my:"bottom",at:"top",of:n,boundary:this._isAppointmentInAllDayPanel(t)?a.$element():a.getWorkSpaceScrollableContainer(),collision:"fit flipfit",offset:this.instance.option("_appointmentTooltipOffset")}})}},hide:function(){this._$tooltip&&(this._$tooltip.remove(),delete this._$tooltip,delete this._tooltip,a.hide())},_isAppointmentInAllDayPanel:function(t){var e=this.instance._workSpace,n;return this.instance.appointmentTakesAllDay(t)&&e.supportAllDayRow()&&e.option("showAllDayPanel")},_initDynamicTemplate:function(t,e,n){var o=this;this.instance._defaultTemplates.appointmentTooltip=new s((function(a){var p=i(a.container),s=o._tooltipContent(t,e,n);return s.addClass(p.attr("class")),p.replaceWith(s),p}))},_tooltipContent:function(t,e,n){var o=i("<div>").addClass(d),a=this.instance.fire("getField","allDay",t),p=this.instance.fire("getField","startDate",e),s=this.instance.fire("getField","endDate",e),l=this.instance.fire("getField","text",t),r=this.instance.fire("getField","startDateTimeZone",t),m=this.instance.fire("getField","endDateTimeZone",t);p=this.instance.fire("convertDateByTimezone",p,r),s=this.instance.fire("convertDateByTimezone",s,m);var f=i("<div>").text(l).addClass(c).appendTo(o);i("<div>").addClass(h).text(this._formatTooltipDate(p,s,a)).appendTo(o);var _=i("<div>").addClass(u);return"top"===this.instance.option("_appointmentTooltipButtonsPosition")?_.prependTo(o):_.appendTo(o),this.instance.option("_appointmentTooltipCloseButton")&&this._getCloseButton().appendTo(_),this.instance.option("_useAppointmentColorForTooltip")&&this.instance.getAppointmentsInstance().notifyObserver("getAppointmentColor",{itemData:t,groupIndex:n.data("dxAppointmentSettings").groupIndex,callback:function(t){t.done((function(t){f.css("backgroundColor",t),_.css("backgroundColor",t)}))}}),this.instance._editing.allowDeleting&&this._getDeleteButton(t,e).appendTo(_),this._getOpenButton(t,e).appendTo(_),o},_formatTooltipDate:function(t,e,n){var i="month"!==this.instance.option("currentView")&&l.sameDate(t,e)?"TIME":"DATETIME",o="";return n&&(i="DATE"),this.instance.fire("formatDates",{startDate:t,endDate:e,formatType:i,callback:function(t){o=t}}),o},_getDeleteButton:function(t,e){var n;return new p(i("<div>").addClass(_),{icon:"trash",onClick:function(){this.instance._checkRecurringAppointment(t,e,e.startDate,function(){this.instance.deleteAppointment(t)}.bind(this),!0),this.hide()}.bind(this)}).$element()},_getOpenButton:function(t,e){var n=this,o=n.instance._editing.allowUpdating,a=this.instance.option("_appointmentTooltipOpenButtonText");return new p(i("<div>").addClass(m),{icon:o?"edit":this.instance.option("_appointmentTooltipOpenButtonIcon"),text:a,onClick:function(){n.instance.showAppointmentPopup(t,!1,e),n.hide()}}).$element()},_getCloseButton:function(){var t=this;return new p(i("<div>").addClass(f),{icon:"close",onClick:function(){t.hide()}}).$element()}};n.exports=T}

